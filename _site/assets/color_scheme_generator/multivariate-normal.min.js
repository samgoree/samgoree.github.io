!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).MultivariateNormal=r()}}(function(){var define,module,exports;return function r(n,e,t){function i(u,c){if(!e[u]){if(!n[u]){var a="function"==typeof require&&require;if(!c&&a)return a(u,!0);if(o)return o(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var s=e[u]={exports:{}};n[u][0].call(s.exports,function(r){return i(n[u][1][r]||r)},s,s.exports,r,n,e,t)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<t.length;u++)i(t[u]);return i}({1:[function(r,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r("./validation.js"),i=u(r("gaussian")),o=u(r("numeric"));function u(r){return r&&r.__esModule?r:{default:r}}var c=(0,i.default)(0,1),a=function r(n,e,i,u){var a=u.u,f=u.s,s=u.v;return{sample:function(){var r=f.map(Math.sqrt),t=s.map(function(n){return n.map(function(n,e){return n*r[e]})}),i=function(r){for(var n=[],e=0;e<r;e++)n.push(c.ppf(Math.random()));return n}(n);return o.default.dot(i,o.default.transpose(t)).map(function(r,n){return r+e[n]})},getMean:function(){return e},setMean:function(e){var o=(0,t.validateMean)(e,n);return r(n,o,i,{u:a,s:f,v:s})},getCov:function(){return i},setCov:function(i){var o=(0,t.validateCovAndGetSVD)(i,n),u=o.cov,c=o.svd;return r(n,e,u,c)}}};e.default=a},{"./validation.js":3,gaussian:4,numeric:9}],2:[function(r,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=u(r("lodash.isarray")),i=r("./validation.js"),o=u(r("./distribution.js"));function u(r){return r&&r.__esModule?r:{default:r}}var c=function(r,n){if(!(0,t.default)(r))throw new Error("mean must be an array");var e=r.length,u=(0,i.validateMean)(r,e),c=(0,i.validateCovAndGetSVD)(n,e),a=c.cov,f=c.svd;return(0,o.default)(e,u,a,f)};e.default=c},{"./distribution.js":1,"./validation.js":3,"lodash.isarray":6}],3:[function(r,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateCovAndGetSVD=e.validateMean=void 0;var t=a(r("lodash.isarray")),i=a(r("lodash.every")),o=a(r("lodash.isnumber")),u=a(r("lodash.some")),c=a(r("numeric"));function a(r){return r&&r.__esModule?r:{default:r}}var f=function r(n){(0,t.default)(n)&&(n.forEach(r),Object.freeze(n))};e.validateMean=function(r,n){if(!(0,t.default)(r))throw new Error("Mean must be an array");if(!(0,i.default)(r,o.default))throw new Error("Mean must be an array of numbers");if(r.length!==n)throw new Error("Expected mean to have length ".concat(n,", but had length ").concat(r.length));return Object.freeze(r),r};e.validateCovAndGetSVD=function(r,n){if(!(0,t.default)(r))throw new Error("Covariance must be an array");if(r.length!==n)throw new Error("Covariance matrix had ".concat(r.length," rows, but it should be a ").concat(n,"x").concat(n," square matrix"));r.forEach(function(r,e){if(!(0,t.default)(r))throw new Error("Row ".concat(e," of covariance matrix was not an array"));if(r.length!==n)throw new Error("Row ".concat(e," of covariance matrix had length ").concat(r.length,", but it should have length ").concat(n));if(!(0,i.default)(r,o.default))throw new Error("Row ".concat(e," of covariance matrix contained a non-numeric value"))});var e=c.default.eig(r).lambda.x;if((0,u.default)(e,function(r){return r<0}))throw new Error("Covariance isn't positive semidefinite");if(!c.default.same(c.default.transpose(r),r))throw new Error("Covariance isn't symmetric");var a=c.default.svd(r),s=a.U,m=a.S,l=a.V;return f(r),f(s),f(m),f(l),{cov:r,svd:{u:s,s:m,v:l}}}},{"lodash.every":5,"lodash.isarray":6,"lodash.isnumber":7,"lodash.some":8,numeric:9}],4:[function(r,n,e){!function(r){var n=function(r){var n=Math.abs(r),e=1/(1+n/2),t=e*Math.exp(-n*n-1.26551223+e*(1.00002368+e*(.37409196+e*(.09678418+e*(e*(.27886807+e*(e*(1.48851587+e*(.17087277*e-.82215223))-1.13520398))-.18628806)))));return r>=0?t:2-t},e=function(r,n){if(n<=0)throw new Error("Variance must be > 0 (but was "+n+")");this.mean=r,this.variance=n,this.standardDeviation=Math.sqrt(n)};e.prototype.pdf=function(r){var n=this.standardDeviation*Math.sqrt(2*Math.PI);return Math.exp(-Math.pow(r-this.mean,2)/(2*this.variance))/n},e.prototype.cdf=function(r){return.5*n(-(r-this.mean)/(this.standardDeviation*Math.sqrt(2)))},e.prototype.ppf=function(r){return this.mean-this.standardDeviation*Math.sqrt(2)*function(r){if(r>=2)return-100;if(r<=0)return 100;for(var e=r<1?r:2-r,t=Math.sqrt(-2*Math.log(e/2)),i=-.70711*((2.30753+.27061*t)/(1+t*(.99229+.04481*t))-t),o=0;o<2;o++){var u=n(i)-e;i+=u/(1.1283791670955126*Math.exp(-i*i)-i*u)}return r<1?i:-i}(2*r)},e.prototype.mul=function(r){if("number"==typeof r)return this.scale(r);var n=1/this.variance,e=1/r.variance;return i(n+e,n*this.mean+e*r.mean)},e.prototype.div=function(r){if("number"==typeof r)return this.scale(1/r);var n=1/this.variance,e=1/r.variance;return i(n-e,n*this.mean-e*r.mean)},e.prototype.add=function(r){return t(this.mean+r.mean,this.variance+r.variance)},e.prototype.sub=function(r){return t(this.mean-r.mean,this.variance+r.variance)},e.prototype.scale=function(r){return t(this.mean*r,this.variance*r*r)};var t=function(r,n){return new e(r,n)},i=function(r,n){return t(n/r,1/r)};r(t)}(void 0!==e?function(r){n.exports=r}:function(r){this.gaussian=r})},{}],5:[function(r,n,e){(function(r){var t=200,i="Expected a function",o="__lodash_hash_undefined__",u=1,c=2,a=1/0,f=9007199254740991,s="[object Arguments]",m="[object Array]",l="[object Boolean]",h="[object Date]",p="[object Error]",v="[object Function]",d="[object GeneratorFunction]",y="[object Map]",g="[object Number]",b="[object Object]",x="[object RegExp]",_="[object Set]",w="[object String]",j="[object Symbol]",M="[object ArrayBuffer]",A="[object DataView]",k=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T=/^\w*$/,S=/^\./,O=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,P=/\\(\\)?/g,V=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F[s]=F[m]=F[M]=F[l]=F[A]=F[h]=F[p]=F[v]=F[y]=F[g]=F[b]=F[x]=F[_]=F[w]=F["[object WeakMap]"]=!1;var E="object"==typeof r&&r&&r.Object===Object&&r,L="object"==typeof self&&self&&self.Object===Object&&self,N=E||L||Function("return this")(),D="object"==typeof e&&e&&!e.nodeType&&e,U=D&&"object"==typeof n&&n&&!n.nodeType&&n,B=U&&U.exports===D&&E.process,R=function(){try{return B&&B.binding("util")}catch(r){}}(),C=R&&R.isTypedArray;function I(r,n){for(var e=-1,t=r?r.length:0;++e<t;)if(!n(r[e],e,r))return!1;return!0}function X(r,n){for(var e=-1,t=r?r.length:0;++e<t;)if(n(r[e],e,r))return!0;return!1}function Y(r){var n=!1;if(null!=r&&"function"!=typeof r.toString)try{n=!!(r+"")}catch(r){}return n}function $(r){var n=-1,e=Array(r.size);return r.forEach(function(r,t){e[++n]=[t,r]}),e}function Q(r){var n=-1,e=Array(r.size);return r.forEach(function(r){e[++n]=r}),e}var z,Z,G,H=Array.prototype,W=Function.prototype,J=Object.prototype,K=N["__core-js_shared__"],rr=(z=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",nr=W.toString,er=J.hasOwnProperty,tr=J.toString,ir=RegExp("^"+nr.call(er).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),or=N.Symbol,ur=N.Uint8Array,cr=J.propertyIsEnumerable,ar=H.splice,fr=(Z=Object.keys,G=Object,function(r){return Z(G(r))}),sr=$r(N,"DataView"),mr=$r(N,"Map"),lr=$r(N,"Promise"),hr=$r(N,"Set"),pr=$r(N,"WeakMap"),vr=$r(Object,"create"),dr=Kr(sr),yr=Kr(mr),gr=Kr(lr),br=Kr(hr),xr=Kr(pr),_r=or?or.prototype:void 0,wr=_r?_r.valueOf:void 0,jr=_r?_r.toString:void 0;function Mr(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function Ar(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function kr(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function Tr(r){var n=-1,e=r?r.length:0;for(this.__data__=new kr;++n<e;)this.add(r[n])}function Sr(r){this.__data__=new Ar(r)}function Or(r,n){var e=tn(r)||en(r)?function(r,n){for(var e=-1,t=Array(r);++e<r;)t[e]=n(e);return t}(r.length,String):[],t=e.length,i=!!t;for(var o in r)!n&&!er.call(r,o)||i&&("length"==o||zr(o,t))||e.push(o);return e}function Pr(r,n){for(var e=r.length;e--;)if(nn(r[e][0],n))return e;return-1}Mr.prototype.clear=function(){this.__data__=vr?vr(null):{}},Mr.prototype.delete=function(r){return this.has(r)&&delete this.__data__[r]},Mr.prototype.get=function(r){var n=this.__data__;if(vr){var e=n[r];return e===o?void 0:e}return er.call(n,r)?n[r]:void 0},Mr.prototype.has=function(r){var n=this.__data__;return vr?void 0!==n[r]:er.call(n,r)},Mr.prototype.set=function(r,n){return this.__data__[r]=vr&&void 0===n?o:n,this},Ar.prototype.clear=function(){this.__data__=[]},Ar.prototype.delete=function(r){var n=this.__data__,e=Pr(n,r);return!(e<0)&&(e==n.length-1?n.pop():ar.call(n,e,1),!0)},Ar.prototype.get=function(r){var n=this.__data__,e=Pr(n,r);return e<0?void 0:n[e][1]},Ar.prototype.has=function(r){return Pr(this.__data__,r)>-1},Ar.prototype.set=function(r,n){var e=this.__data__,t=Pr(e,r);return t<0?e.push([r,n]):e[t][1]=n,this},kr.prototype.clear=function(){this.__data__={hash:new Mr,map:new(mr||Ar),string:new Mr}},kr.prototype.delete=function(r){return Yr(this,r).delete(r)},kr.prototype.get=function(r){return Yr(this,r).get(r)},kr.prototype.has=function(r){return Yr(this,r).has(r)},kr.prototype.set=function(r,n){return Yr(this,r).set(r,n),this},Tr.prototype.add=Tr.prototype.push=function(r){return this.__data__.set(r,o),this},Tr.prototype.has=function(r){return this.__data__.has(r)},Sr.prototype.clear=function(){this.__data__=new Ar},Sr.prototype.delete=function(r){return this.__data__.delete(r)},Sr.prototype.get=function(r){return this.__data__.get(r)},Sr.prototype.has=function(r){return this.__data__.has(r)},Sr.prototype.set=function(r,n){var e=this.__data__;if(e instanceof Ar){var i=e.__data__;if(!mr||i.length<t-1)return i.push([r,n]),this;e=this.__data__=new kr(i)}return e.set(r,n),this};var Vr,qr,Fr=(Vr=function(r,n){return r&&Lr(r,n,ln)},function(r,n){if(null==r)return r;if(!on(r))return Vr(r,n);for(var e=r.length,t=qr?e:-1,i=Object(r);(qr?t--:++t<e)&&!1!==n(i[t],t,i););return r});function Er(r,n){var e=!0;return Fr(r,function(r,t,i){return e=!!n(r,t,i)}),e}var Lr=function(r){return function(n,e,t){for(var i=-1,o=Object(n),u=t(n),c=u.length;c--;){var a=u[r?c:++i];if(!1===e(o[a],a,o))break}return n}}();function Nr(r,n){for(var e=0,t=(n=Zr(n,r)?[n]:Ir(n)).length;null!=r&&e<t;)r=r[Jr(n[e++])];return e&&e==t?r:void 0}function Dr(r,n){return null!=r&&n in Object(r)}function Ur(r,n,e,t,i){return r===n||(null==r||null==n||!an(r)&&!fn(n)?r!=r&&n!=n:function(r,n,e,t,i,o){var a=tn(r),f=tn(n),v=m,d=m;a||(v=(v=Qr(r))==s?b:v);f||(d=(d=Qr(n))==s?b:d);var k=v==b&&!Y(r),T=d==b&&!Y(n),S=v==d;if(S&&!k)return o||(o=new Sr),a||mn(r)?Xr(r,n,e,t,i,o):function(r,n,e,t,i,o,a){switch(e){case A:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case M:return!(r.byteLength!=n.byteLength||!t(new ur(r),new ur(n)));case l:case h:case g:return nn(+r,+n);case p:return r.name==n.name&&r.message==n.message;case x:case w:return r==n+"";case y:var f=$;case _:var s=o&c;if(f||(f=Q),r.size!=n.size&&!s)return!1;var m=a.get(r);if(m)return m==n;o|=u,a.set(r,n);var v=Xr(f(r),f(n),t,i,o,a);return a.delete(r),v;case j:if(wr)return wr.call(r)==wr.call(n)}return!1}(r,n,v,e,t,i,o);if(!(i&c)){var O=k&&er.call(r,"__wrapped__"),P=T&&er.call(n,"__wrapped__");if(O||P){var V=O?r.value():r,q=P?n.value():n;return o||(o=new Sr),e(V,q,t,i,o)}}if(!S)return!1;return o||(o=new Sr),function(r,n,e,t,i,o){var u=i&c,a=ln(r),f=a.length,s=ln(n).length;if(f!=s&&!u)return!1;var m=f;for(;m--;){var l=a[m];if(!(u?l in n:er.call(n,l)))return!1}var h=o.get(r);if(h&&o.get(n))return h==n;var p=!0;o.set(r,n),o.set(n,r);var v=u;for(;++m<f;){l=a[m];var d=r[l],y=n[l];if(t)var g=u?t(y,d,l,n,r,o):t(d,y,l,r,n,o);if(!(void 0===g?d===y||e(d,y,t,i,o):g)){p=!1;break}v||(v="constructor"==l)}if(p&&!v){var b=r.constructor,x=n.constructor;b!=x&&"constructor"in r&&"constructor"in n&&!("function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x)&&(p=!1)}return o.delete(r),o.delete(n),p}(r,n,e,t,i,o)}(r,n,Ur,e,t,i))}function Br(r){return!(!an(r)||function(r){return!!rr&&rr in r}(r))&&(un(r)||Y(r)?ir:V).test(Kr(r))}function Rr(r){return"function"==typeof r?r:null==r?hn:"object"==typeof r?tn(r)?function(r,n){if(Zr(r)&&Gr(n))return Hr(Jr(r),n);return function(e){var t=function(r,n,e){var t=null==r?void 0:Nr(r,n);return void 0===t?e:t}(e,r);return void 0===t&&t===n?function(r,n){return null!=r&&function(r,n,e){n=Zr(n,r)?[n]:Ir(n);var t,i=-1,o=n.length;for(;++i<o;){var u=Jr(n[i]);if(!(t=null!=r&&e(r,u)))break;r=r[u]}if(t)return t;return!!(o=r?r.length:0)&&cn(o)&&zr(u,o)&&(tn(r)||en(r))}(r,n,Dr)}(e,r):Ur(n,t,void 0,u|c)}}(r[0],r[1]):function(r){var n=function(r){var n=ln(r),e=n.length;for(;e--;){var t=n[e],i=r[t];n[e]=[t,i,Gr(i)]}return n}(r);if(1==n.length&&n[0][2])return Hr(n[0][0],n[0][1]);return function(e){return e===r||function(r,n,e,t){var i=e.length,o=i,a=!t;if(null==r)return!o;for(r=Object(r);i--;){var f=e[i];if(a&&f[2]?f[1]!==r[f[0]]:!(f[0]in r))return!1}for(;++i<o;){var s=(f=e[i])[0],m=r[s],l=f[1];if(a&&f[2]){if(void 0===m&&!(s in r))return!1}else{var h=new Sr;if(t)var p=t(m,l,s,r,n,h);if(!(void 0===p?Ur(l,m,t,u|c,h):p))return!1}}return!0}(e,r,n)}}(r):Zr(n=r)?(e=Jr(n),function(r){return null==r?void 0:r[e]}):function(r){return function(n){return Nr(n,r)}}(n);var n,e}function Cr(r){if(e=(n=r)&&n.constructor,t="function"==typeof e&&e.prototype||J,n!==t)return fr(r);var n,e,t,i=[];for(var o in Object(r))er.call(r,o)&&"constructor"!=o&&i.push(o);return i}function Ir(r){return tn(r)?r:Wr(r)}function Xr(r,n,e,t,i,o){var a=i&c,f=r.length,s=n.length;if(f!=s&&!(a&&s>f))return!1;var m=o.get(r);if(m&&o.get(n))return m==n;var l=-1,h=!0,p=i&u?new Tr:void 0;for(o.set(r,n),o.set(n,r);++l<f;){var v=r[l],d=n[l];if(t)var y=a?t(d,v,l,n,r,o):t(v,d,l,r,n,o);if(void 0!==y){if(y)continue;h=!1;break}if(p){if(!X(n,function(r,n){if(!p.has(n)&&(v===r||e(v,r,t,i,o)))return p.add(n)})){h=!1;break}}else if(v!==d&&!e(v,d,t,i,o)){h=!1;break}}return o.delete(r),o.delete(n),h}function Yr(r,n){var e,t,i=r.__data__;return("string"==(t=typeof(e=n))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e)?i["string"==typeof n?"string":"hash"]:i.map}function $r(r,n){var e=function(r,n){return null==r?void 0:r[n]}(r,n);return Br(e)?e:void 0}var Qr=function(r){return tr.call(r)};function zr(r,n){return!!(n=null==n?f:n)&&("number"==typeof r||q.test(r))&&r>-1&&r%1==0&&r<n}function Zr(r,n){if(tn(r))return!1;var e=typeof r;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=r&&!sn(r))||(T.test(r)||!k.test(r)||null!=n&&r in Object(n))}function Gr(r){return r==r&&!an(r)}function Hr(r,n){return function(e){return null!=e&&(e[r]===n&&(void 0!==n||r in Object(e)))}}(sr&&Qr(new sr(new ArrayBuffer(1)))!=A||mr&&Qr(new mr)!=y||lr&&"[object Promise]"!=Qr(lr.resolve())||hr&&Qr(new hr)!=_||pr&&"[object WeakMap]"!=Qr(new pr))&&(Qr=function(r){var n=tr.call(r),e=n==b?r.constructor:void 0,t=e?Kr(e):void 0;if(t)switch(t){case dr:return A;case yr:return y;case gr:return"[object Promise]";case br:return _;case xr:return"[object WeakMap]"}return n});var Wr=rn(function(r){var n;r=null==(n=r)?"":function(r){if("string"==typeof r)return r;if(sn(r))return jr?jr.call(r):"";var n=r+"";return"0"==n&&1/r==-a?"-0":n}(n);var e=[];return S.test(r)&&e.push(""),r.replace(O,function(r,n,t,i){e.push(t?i.replace(P,"$1"):n||r)}),e});function Jr(r){if("string"==typeof r||sn(r))return r;var n=r+"";return"0"==n&&1/r==-a?"-0":n}function Kr(r){if(null!=r){try{return nr.call(r)}catch(r){}try{return r+""}catch(r){}}return""}function rn(r,n){if("function"!=typeof r||n&&"function"!=typeof n)throw new TypeError(i);var e=function(){var t=arguments,i=n?n.apply(this,t):t[0],o=e.cache;if(o.has(i))return o.get(i);var u=r.apply(this,t);return e.cache=o.set(i,u),u};return e.cache=new(rn.Cache||kr),e}function nn(r,n){return r===n||r!=r&&n!=n}function en(r){return function(r){return fn(r)&&on(r)}(r)&&er.call(r,"callee")&&(!cr.call(r,"callee")||tr.call(r)==s)}rn.Cache=kr;var tn=Array.isArray;function on(r){return null!=r&&cn(r.length)&&!un(r)}function un(r){var n=an(r)?tr.call(r):"";return n==v||n==d}function cn(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=f}function an(r){var n=typeof r;return!!r&&("object"==n||"function"==n)}function fn(r){return!!r&&"object"==typeof r}function sn(r){return"symbol"==typeof r||fn(r)&&tr.call(r)==j}var mn=C?function(r){return function(n){return r(n)}}(C):function(r){return fn(r)&&cn(r.length)&&!!F[tr.call(r)]};function ln(r){return on(r)?Or(r):Cr(r)}function hn(r){return r}n.exports=function(r,n,e){var t=tn(r)?I:Er;return e&&function(r,n,e){if(!an(e))return!1;var t=typeof n;return!!("number"==t?on(e)&&zr(n,e.length):"string"==t&&n in e)&&nn(e[n],r)}(r,n,e)&&(n=void 0),t(r,Rr(n))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(r,n,e){var t=Array.isArray;n.exports=t},{}],7:[function(r,n,e){var t="[object Number]",i=Object.prototype.toString;n.exports=function(r){return"number"==typeof r||function(r){return!!r&&"object"==typeof r}(r)&&i.call(r)==t}},{}],8:[function(r,n,e){(function(r){var t=200,i="Expected a function",o="__lodash_hash_undefined__",u=1,c=2,a=1/0,f=9007199254740991,s="[object Arguments]",m="[object Array]",l="[object Boolean]",h="[object Date]",p="[object Error]",v="[object Function]",d="[object GeneratorFunction]",y="[object Map]",g="[object Number]",b="[object Object]",x="[object RegExp]",_="[object Set]",w="[object String]",j="[object Symbol]",M="[object ArrayBuffer]",A="[object DataView]",k=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T=/^\w*$/,S=/^\./,O=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,P=/\\(\\)?/g,V=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F[s]=F[m]=F[M]=F[l]=F[A]=F[h]=F[p]=F[v]=F[y]=F[g]=F[b]=F[x]=F[_]=F[w]=F["[object WeakMap]"]=!1;var E="object"==typeof r&&r&&r.Object===Object&&r,L="object"==typeof self&&self&&self.Object===Object&&self,N=E||L||Function("return this")(),D="object"==typeof e&&e&&!e.nodeType&&e,U=D&&"object"==typeof n&&n&&!n.nodeType&&n,B=U&&U.exports===D&&E.process,R=function(){try{return B&&B.binding("util")}catch(r){}}(),C=R&&R.isTypedArray;function I(r,n){for(var e=-1,t=r?r.length:0;++e<t;)if(n(r[e],e,r))return!0;return!1}function X(r){var n=!1;if(null!=r&&"function"!=typeof r.toString)try{n=!!(r+"")}catch(r){}return n}function Y(r){var n=-1,e=Array(r.size);return r.forEach(function(r,t){e[++n]=[t,r]}),e}function $(r){var n=-1,e=Array(r.size);return r.forEach(function(r){e[++n]=r}),e}var Q,z,Z,G=Array.prototype,H=Function.prototype,W=Object.prototype,J=N["__core-js_shared__"],K=(Q=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+Q:"",rr=H.toString,nr=W.hasOwnProperty,er=W.toString,tr=RegExp("^"+rr.call(nr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ir=N.Symbol,or=N.Uint8Array,ur=W.propertyIsEnumerable,cr=G.splice,ar=(z=Object.keys,Z=Object,function(r){return z(Z(r))}),fr=Yr(N,"DataView"),sr=Yr(N,"Map"),mr=Yr(N,"Promise"),lr=Yr(N,"Set"),hr=Yr(N,"WeakMap"),pr=Yr(Object,"create"),vr=Jr(fr),dr=Jr(sr),yr=Jr(mr),gr=Jr(lr),br=Jr(hr),xr=ir?ir.prototype:void 0,_r=xr?xr.valueOf:void 0,wr=xr?xr.toString:void 0;function jr(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function Mr(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function Ar(r){var n=-1,e=r?r.length:0;for(this.clear();++n<e;){var t=r[n];this.set(t[0],t[1])}}function kr(r){var n=-1,e=r?r.length:0;for(this.__data__=new Ar;++n<e;)this.add(r[n])}function Tr(r){this.__data__=new Mr(r)}function Sr(r,n){var e=en(r)||nn(r)?function(r,n){for(var e=-1,t=Array(r);++e<r;)t[e]=n(e);return t}(r.length,String):[],t=e.length,i=!!t;for(var o in r)!n&&!nr.call(r,o)||i&&("length"==o||Qr(o,t))||e.push(o);return e}function Or(r,n){for(var e=r.length;e--;)if(rn(r[e][0],n))return e;return-1}jr.prototype.clear=function(){this.__data__=pr?pr(null):{}},jr.prototype.delete=function(r){return this.has(r)&&delete this.__data__[r]},jr.prototype.get=function(r){var n=this.__data__;if(pr){var e=n[r];return e===o?void 0:e}return nr.call(n,r)?n[r]:void 0},jr.prototype.has=function(r){var n=this.__data__;return pr?void 0!==n[r]:nr.call(n,r)},jr.prototype.set=function(r,n){return this.__data__[r]=pr&&void 0===n?o:n,this},Mr.prototype.clear=function(){this.__data__=[]},Mr.prototype.delete=function(r){var n=this.__data__,e=Or(n,r);return!(e<0)&&(e==n.length-1?n.pop():cr.call(n,e,1),!0)},Mr.prototype.get=function(r){var n=this.__data__,e=Or(n,r);return e<0?void 0:n[e][1]},Mr.prototype.has=function(r){return Or(this.__data__,r)>-1},Mr.prototype.set=function(r,n){var e=this.__data__,t=Or(e,r);return t<0?e.push([r,n]):e[t][1]=n,this},Ar.prototype.clear=function(){this.__data__={hash:new jr,map:new(sr||Mr),string:new jr}},Ar.prototype.delete=function(r){return Xr(this,r).delete(r)},Ar.prototype.get=function(r){return Xr(this,r).get(r)},Ar.prototype.has=function(r){return Xr(this,r).has(r)},Ar.prototype.set=function(r,n){return Xr(this,r).set(r,n),this},kr.prototype.add=kr.prototype.push=function(r){return this.__data__.set(r,o),this},kr.prototype.has=function(r){return this.__data__.has(r)},Tr.prototype.clear=function(){this.__data__=new Mr},Tr.prototype.delete=function(r){return this.__data__.delete(r)},Tr.prototype.get=function(r){return this.__data__.get(r)},Tr.prototype.has=function(r){return this.__data__.has(r)},Tr.prototype.set=function(r,n){var e=this.__data__;if(e instanceof Mr){var i=e.__data__;if(!sr||i.length<t-1)return i.push([r,n]),this;e=this.__data__=new Ar(i)}return e.set(r,n),this};var Pr,Vr,qr=(Pr=function(r,n){return r&&Fr(r,n,mn)},function(r,n){if(null==r)return r;if(!tn(r))return Pr(r,n);for(var e=r.length,t=Vr?e:-1,i=Object(r);(Vr?t--:++t<e)&&!1!==n(i[t],t,i););return r}),Fr=function(r){return function(n,e,t){for(var i=-1,o=Object(n),u=t(n),c=u.length;c--;){var a=u[r?c:++i];if(!1===e(o[a],a,o))break}return n}}();function Er(r,n){for(var e=0,t=(n=zr(n,r)?[n]:Cr(n)).length;null!=r&&e<t;)r=r[Wr(n[e++])];return e&&e==t?r:void 0}function Lr(r,n){return null!=r&&n in Object(r)}function Nr(r,n,e,t,i){return r===n||(null==r||null==n||!cn(r)&&!an(n)?r!=r&&n!=n:function(r,n,e,t,i,o){var a=en(r),f=en(n),v=m,d=m;a||(v=(v=$r(r))==s?b:v);f||(d=(d=$r(n))==s?b:d);var k=v==b&&!X(r),T=d==b&&!X(n),S=v==d;if(S&&!k)return o||(o=new Tr),a||sn(r)?Ir(r,n,e,t,i,o):function(r,n,e,t,i,o,a){switch(e){case A:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case M:return!(r.byteLength!=n.byteLength||!t(new or(r),new or(n)));case l:case h:case g:return rn(+r,+n);case p:return r.name==n.name&&r.message==n.message;case x:case w:return r==n+"";case y:var f=Y;case _:var s=o&c;if(f||(f=$),r.size!=n.size&&!s)return!1;var m=a.get(r);if(m)return m==n;o|=u,a.set(r,n);var v=Ir(f(r),f(n),t,i,o,a);return a.delete(r),v;case j:if(_r)return _r.call(r)==_r.call(n)}return!1}(r,n,v,e,t,i,o);if(!(i&c)){var O=k&&nr.call(r,"__wrapped__"),P=T&&nr.call(n,"__wrapped__");if(O||P){var V=O?r.value():r,q=P?n.value():n;return o||(o=new Tr),e(V,q,t,i,o)}}if(!S)return!1;return o||(o=new Tr),function(r,n,e,t,i,o){var u=i&c,a=mn(r),f=a.length,s=mn(n).length;if(f!=s&&!u)return!1;var m=f;for(;m--;){var l=a[m];if(!(u?l in n:nr.call(n,l)))return!1}var h=o.get(r);if(h&&o.get(n))return h==n;var p=!0;o.set(r,n),o.set(n,r);var v=u;for(;++m<f;){l=a[m];var d=r[l],y=n[l];if(t)var g=u?t(y,d,l,n,r,o):t(d,y,l,r,n,o);if(!(void 0===g?d===y||e(d,y,t,i,o):g)){p=!1;break}v||(v="constructor"==l)}if(p&&!v){var b=r.constructor,x=n.constructor;b!=x&&"constructor"in r&&"constructor"in n&&!("function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x)&&(p=!1)}return o.delete(r),o.delete(n),p}(r,n,e,t,i,o)}(r,n,Nr,e,t,i))}function Dr(r){return!(!cn(r)||function(r){return!!K&&K in r}(r))&&(on(r)||X(r)?tr:V).test(Jr(r))}function Ur(r){return"function"==typeof r?r:null==r?ln:"object"==typeof r?en(r)?function(r,n){if(zr(r)&&Zr(n))return Gr(Wr(r),n);return function(e){var t=function(r,n,e){var t=null==r?void 0:Er(r,n);return void 0===t?e:t}(e,r);return void 0===t&&t===n?function(r,n){return null!=r&&function(r,n,e){n=zr(n,r)?[n]:Cr(n);var t,i=-1,o=n.length;for(;++i<o;){var u=Wr(n[i]);if(!(t=null!=r&&e(r,u)))break;r=r[u]}if(t)return t;return!!(o=r?r.length:0)&&un(o)&&Qr(u,o)&&(en(r)||nn(r))}(r,n,Lr)}(e,r):Nr(n,t,void 0,u|c)}}(r[0],r[1]):function(r){var n=function(r){var n=mn(r),e=n.length;for(;e--;){var t=n[e],i=r[t];n[e]=[t,i,Zr(i)]}return n}(r);if(1==n.length&&n[0][2])return Gr(n[0][0],n[0][1]);return function(e){return e===r||function(r,n,e,t){var i=e.length,o=i,a=!t;if(null==r)return!o;for(r=Object(r);i--;){var f=e[i];if(a&&f[2]?f[1]!==r[f[0]]:!(f[0]in r))return!1}for(;++i<o;){var s=(f=e[i])[0],m=r[s],l=f[1];if(a&&f[2]){if(void 0===m&&!(s in r))return!1}else{var h=new Tr;if(t)var p=t(m,l,s,r,n,h);if(!(void 0===p?Nr(l,m,t,u|c,h):p))return!1}}return!0}(e,r,n)}}(r):zr(n=r)?(e=Wr(n),function(r){return null==r?void 0:r[e]}):function(r){return function(n){return Er(n,r)}}(n);var n,e}function Br(r){if(e=(n=r)&&n.constructor,t="function"==typeof e&&e.prototype||W,n!==t)return ar(r);var n,e,t,i=[];for(var o in Object(r))nr.call(r,o)&&"constructor"!=o&&i.push(o);return i}function Rr(r,n){var e;return qr(r,function(r,t,i){return!(e=n(r,t,i))}),!!e}function Cr(r){return en(r)?r:Hr(r)}function Ir(r,n,e,t,i,o){var a=i&c,f=r.length,s=n.length;if(f!=s&&!(a&&s>f))return!1;var m=o.get(r);if(m&&o.get(n))return m==n;var l=-1,h=!0,p=i&u?new kr:void 0;for(o.set(r,n),o.set(n,r);++l<f;){var v=r[l],d=n[l];if(t)var y=a?t(d,v,l,n,r,o):t(v,d,l,r,n,o);if(void 0!==y){if(y)continue;h=!1;break}if(p){if(!I(n,function(r,n){if(!p.has(n)&&(v===r||e(v,r,t,i,o)))return p.add(n)})){h=!1;break}}else if(v!==d&&!e(v,d,t,i,o)){h=!1;break}}return o.delete(r),o.delete(n),h}function Xr(r,n){var e,t,i=r.__data__;return("string"==(t=typeof(e=n))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e)?i["string"==typeof n?"string":"hash"]:i.map}function Yr(r,n){var e=function(r,n){return null==r?void 0:r[n]}(r,n);return Dr(e)?e:void 0}var $r=function(r){return er.call(r)};function Qr(r,n){return!!(n=null==n?f:n)&&("number"==typeof r||q.test(r))&&r>-1&&r%1==0&&r<n}function zr(r,n){if(en(r))return!1;var e=typeof r;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=r&&!fn(r))||(T.test(r)||!k.test(r)||null!=n&&r in Object(n))}function Zr(r){return r==r&&!cn(r)}function Gr(r,n){return function(e){return null!=e&&(e[r]===n&&(void 0!==n||r in Object(e)))}}(fr&&$r(new fr(new ArrayBuffer(1)))!=A||sr&&$r(new sr)!=y||mr&&"[object Promise]"!=$r(mr.resolve())||lr&&$r(new lr)!=_||hr&&"[object WeakMap]"!=$r(new hr))&&($r=function(r){var n=er.call(r),e=n==b?r.constructor:void 0,t=e?Jr(e):void 0;if(t)switch(t){case vr:return A;case dr:return y;case yr:return"[object Promise]";case gr:return _;case br:return"[object WeakMap]"}return n});var Hr=Kr(function(r){var n;r=null==(n=r)?"":function(r){if("string"==typeof r)return r;if(fn(r))return wr?wr.call(r):"";var n=r+"";return"0"==n&&1/r==-a?"-0":n}(n);var e=[];return S.test(r)&&e.push(""),r.replace(O,function(r,n,t,i){e.push(t?i.replace(P,"$1"):n||r)}),e});function Wr(r){if("string"==typeof r||fn(r))return r;var n=r+"";return"0"==n&&1/r==-a?"-0":n}function Jr(r){if(null!=r){try{return rr.call(r)}catch(r){}try{return r+""}catch(r){}}return""}function Kr(r,n){if("function"!=typeof r||n&&"function"!=typeof n)throw new TypeError(i);var e=function(){var t=arguments,i=n?n.apply(this,t):t[0],o=e.cache;if(o.has(i))return o.get(i);var u=r.apply(this,t);return e.cache=o.set(i,u),u};return e.cache=new(Kr.Cache||Ar),e}function rn(r,n){return r===n||r!=r&&n!=n}function nn(r){return function(r){return an(r)&&tn(r)}(r)&&nr.call(r,"callee")&&(!ur.call(r,"callee")||er.call(r)==s)}Kr.Cache=Ar;var en=Array.isArray;function tn(r){return null!=r&&un(r.length)&&!on(r)}function on(r){var n=cn(r)?er.call(r):"";return n==v||n==d}function un(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=f}function cn(r){var n=typeof r;return!!r&&("object"==n||"function"==n)}function an(r){return!!r&&"object"==typeof r}function fn(r){return"symbol"==typeof r||an(r)&&er.call(r)==j}var sn=C?function(r){return function(n){return r(n)}}(C):function(r){return an(r)&&un(r.length)&&!!F[er.call(r)]};function mn(r){return tn(r)?Sr(r):Br(r)}function ln(r){return r}n.exports=function(r,n,e){var t=en(r)?I:Rr;return e&&function(r,n,e){if(!cn(e))return!1;var t=typeof n;return!!("number"==t?tn(e)&&Qr(n,e.length):"string"==t&&n in e)&&rn(e[n],r)}(r,n,e)&&(n=void 0),t(r,Ur(n))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(require,module,exports){(function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,t,i;for(void 0===n&&(n=15),t=.5,e=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-e>n)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){var n=[];return function r(e){var t;if(void 0===e)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return n.push('"'+e+'"'),!1;if("boolean"==typeof e)return n.push(e.toString()),!1;if("number"==typeof e){var i=function r(n){if(0===n)return"0";if(isNaN(n))return"NaN";if(n<0)return"-"+r(-n);if(isFinite(n)){var e=Math.floor(Math.log(n)/Math.log(10)),t=n/Math.pow(10,e),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(e++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+e.toString()}return"Infinity"}(e),o=e.toPrecision(numeric.precision),u=parseFloat(e.toString()).toString(),c=[i,o,u,parseFloat(o).toString(),parseFloat(u).toString()];for(t=1;t<c.length;t++)c[t].length<i.length&&(i=c[t]);return n.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===e)return n.push("null"),!1;if("function"==typeof e){n.push(e.toString());var a=!1;for(t in e)e.hasOwnProperty(t)&&(a?n.push(",\n"):n.push("\n{"),a=!0,n.push(t),n.push(": \n"),r(e[t]));return a&&n.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return n.push("...Large Array..."),!0;for(a=!1,n.push("["),t=0;t<e.length;t++)t>0&&(n.push(","),a&&n.push("\n ")),a=r(e[t]);return n.push("]"),!0}n.push("{");a=!1;for(t in e)e.hasOwnProperty(t)&&(a&&n.push(",\n"),a=!0,n.push(t),n.push(": \n"),r(e[t]));return n.push("}"),!0}(r),n.join("")},numeric.parseDate=function(r){return function r(n){if("string"==typeof n)return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseFloat=function(r){return function r(n){if("string"==typeof n)return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseCSV=function(r){var n,e,t,i=r.split("\n"),o=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,c=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=0;for(e=0;e<i.length;e++){var f,s=(i[e]+",").match(u);if(s.length>0){for(o[a]=[],n=0;n<s.length;n++)f=(t=s[n]).substr(0,t.length-1),c.test(f)?o[a][n]=parseFloat(f):o[a][n]=f;a++}}return o},numeric.toCSV=function(r){var n,e,t,i,o,u=numeric.dim(r);for(t=u[0],u[1],o=[],n=0;n<t;n++){for(i=[],e=0;e<t;e++)i[e]=r[n][e].toString();o[n]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;r.length;for(t=n;t<e;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var e,t,i,o,u,c,a,f,s,m,l=r[0].length,h=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,l>>24&255,l>>16&255,l>>8&255,255&l,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,e=1,t=0,a=0;a<l;a++){for(a<l-1?p.push(0):p.push(1),u=3*h+1+(0===a)&255,c=3*h+1+(0===a)>>8&255,p.push(u),p.push(c),p.push(255&~u),p.push(255&~c),0===a&&p.push(0),f=0;f<h;f++)for(i=0;i<3;i++)t=(t+(e=(e+(u=(u=r[i][a][f])>255?255:u<0?0:Math.round(u)))%65521))%65521,p.push(u);p.push(0)}return s=(t<<16)+e,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,m=n(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var n,e,t,i,o,u,c,a=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(n=0;n<a;n+=3)o=((3&(e=r[n]))<<4)+((t=r[n+1])>>4),u=((15&t)<<2)+((i=r[n+2])>>6),c=63&i,n+1>=a?u=c=64:n+2>=a&&(c=64),s+=f.charAt(e>>2)+f.charAt(o)+f.charAt(u)+f.charAt(c);return s}(p)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;return"object"==typeof r?"object"==typeof(n=r[0])?"object"==typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length]:[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var t,i;if(!(n instanceof Array&&e instanceof Array))return!1;if((i=n.length)!==e.length)return!1;for(t=0;t<i;t++)if(n[t]!==e[t]){if("object"!=typeof n[t])return!1;if(!r(n[t],e[t]))return!1}return!0},numeric.rep=function(r,n,e){void 0===e&&(e=0);var t,i=r[e],o=Array(i);if(e===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=n,o[t]=n;return-1===t&&(o[0]=n),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,n,e+1);return o},numeric.dotMMsmall=function(r,n){var e,t,i,o,u,c,a,f,s,m,l;for(o=r.length,u=n.length,c=n[0].length,a=Array(o),e=o-1;e>=0;e--){for(f=Array(c),s=r[e],i=c-1;i>=0;i--){for(m=s[u-1]*n[u-1][i],t=u-2;t>=1;t-=2)l=t-1,m+=s[t]*n[t][i]+s[l]*n[l][i];0===t&&(m+=s[0]*n[0][i]),f[i]=m}a[e]=f}return a},numeric._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,t,i,o=numeric._getCol,u=n.length,c=Array(u),a=r.length,f=n[0].length,s=new Array(a),m=numeric.dotVV;for(--u,t=--a;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(o(n,t,c),i=a;-1!==i;--i)0,e=r[i],s[i][t]=m(e,c);return s},numeric.dotMV=function(r,n){var e,t=r.length,i=(n.length,Array(t)),o=numeric.dotVV;for(e=t-1;e>=0;e--)i[e]=o(r[e],n);return i},numeric.dotVM=function(r,n){var e,t,i,o,u,c,a;for(i=r.length,o=n[0].length,u=Array(o),t=o-1;t>=0;t--){for(c=r[i-1]*n[i-1][t],e=i-2;e>=1;e-=2)a=e-1,c+=r[e]*n[e][t]+r[a]*n[a][t];0===e&&(c+=r[0]*n[0][t]),u[t]=c}return u},numeric.dotVV=function(r,n){var e,t,i=r.length,o=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,o+=r[e]*n[e]+r[t]*n[t];return 0===e&&(o+=r[0]*n[0]),o},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,t,i,o=r.length,u=Array(o);for(n=o-1;n>=0;n--){for(i=Array(o),e=n+2,t=o-1;t>=e;t-=2)i[t]=0,i[t-1]=0;for(t>n&&(i[t]=0),i[n]=r[n],t=n-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[n]=i}return u},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){void 0===e&&(e="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(a?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,n,e){void 0===e&&(e="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="var _n = "+c+".length;\nvar i"+(a?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(n,e,t,i,o){var u;if(i!==t.length-1)for(u=t[i]-1;u>=0;u--)r("object"==typeof n?n[u]:n,"object"==typeof e?e[u]:e,t,i+1,o);else o(n,e)},numeric._biforeach2=function r(n,e,t,i,o){if(i===t.length-1)return o(n,e);var u,c=t[i],a=Array(c);for(u=c-1;u>=0;--u)a[u]=r("object"==typeof n?n[u]:n,"object"==typeof e?e[u]:e,t,i+1,o);return a},numeric._foreach=function r(n,e,t,i){var o;if(t!==e.length-1)for(o=e[t]-1;o>=0;o--)r(n[o],e,t+1,i);else i(n)},numeric._foreach2=function r(n,e,t,i){if(t===e.length-1)return i(n);var o,u=e[t],c=Array(u);for(o=u-1;o>=0;o--)c[o]=r(n[o],e,t+1,i);return c},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+n+" = Math."+n+";\n",e=function(r,e,t){return r+" = "+n+"("+e+","+t+")"},t=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,t){return r+" = "+e+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var n,e,t,i,o,u,c,a=numeric.dim(r),f=Math.abs,s=a[0],m=a[1],l=numeric.clone(r),h=numeric.identity(s);for(u=0;u<m;++u){var p=-1,v=-1;for(o=u;o!==s;++o)(c=f(l[o][u]))>v&&(p=o,v=c);for(e=l[p],l[p]=l[u],l[u]=e,i=h[p],h[p]=h[u],h[u]=i,r=e[u],c=u;c!==m;++c)e[c]/=r;for(c=m-1;-1!==c;--c)i[c]/=r;for(o=s-1;-1!==o;--o)if(o!==u){for(n=l[o],t=h[o],r=n[u],c=u+1;c!==m;++c)n[c]-=e[c]*r;for(c=m-1;c>0;--c)t[c]-=i[c]*r,t[--c]-=i[c]*r;0===c&&(t[0]-=i[0]*r)}}return h},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var e,t,i,o,u,c,a,f,s=n[0],m=1,l=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,e=t+1;e<s;e++)Math.abs(l[e][t])>Math.abs(l[i][t])&&(i=e);for(i!==t&&(a=l[i],l[i]=l[t],l[t]=a,m*=-1),o=l[t],e=t+1;e<s;e++){for(c=(u=l[e])[t]/o[t],i=t+1;i<s-1;i+=2)f=i+1,u[i]-=o[i]*c,u[f]-=o[f]*c;i!==s&&(u[i]-=o[i]*c)}if(0===o[t])return 0;m*=o[t]}return m*l[t][t]},numeric.transpose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=i[e],o[n-1]=t[e],(o=a[--e])[n]=i[e],o[n-1]=t[e];0===e&&((o=a[0])[n]=i[0],o[n-1]=t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=t[e],a[--e][0]=t[e];0===e&&(a[0][0]=t[0])}return a},numeric.negtranspose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=-i[e],o[n-1]=-t[e],(o=a[--e])[n]=-i[e],o[n-1]=-t[e];0===e&&((o=a[0])[n]=-i[0],o[n-1]=-t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=-t[e],a[--e][0]=-t[e];0===e&&(a[0][0]=-t[0])}return a},numeric._random=function r(n,e){var t,i,o=n[e],u=Array(o);if(e===n.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(n,e+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,i=Array(e);for(t=--e;t>=0;t--)i[t]=(t*n+(e-t)*r)/e;return i},numeric.getBlock=function(r,n,e){var t=numeric.dim(r);return function r(i,o){var u,c=n[o],a=e[o]-c,f=Array(a);if(o===t.length-1){for(u=a;u>=0;u--)f[u]=i[u+c];return f}for(u=a;u>=0;u--)f[u]=r(i[u+c],o+1);return f}(r,0)},numeric.setBlock=function(r,n,e,t){var i=numeric.dim(r);return function r(t,o,u){var c,a=n[u],f=e[u]-a;if(u===i.length-1)for(c=f;c>=0;c--)t[c+a]=o[c];for(c=f;c>=0;c--)r(t[c+a],o[c],u+1)}(r,t,0),r},numeric.getRange=function(r,n,e){var t,i,o,u,c=n.length,a=e.length,f=Array(c);for(t=c-1;-1!==t;--t)for(f[t]=Array(a),o=f[t],u=r[n[t]],i=a-1;-1!==i;--i)o[i]=u[e[i]];return f},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,t,i,o,u,c=n[0],a=n[1];for(e=0,t=0,i=0;i<c;++i)e+=r[i][0].length;for(o=0;o<a;++o)t+=r[0][o][0].length;var f=Array(e);for(i=0;i<e;++i)f[i]=Array(t);var s,m,l,h,p,v=0;for(i=0;i<c;++i){for(s=t,o=a-1;-1!==o;--o)for(s-=(u=r[i][o])[0].length,l=u.length-1;-1!==l;--l)for(p=u[l],m=f[v+l],h=p.length-1;-1!==h;--h)m[s+h]=p[h];v+=r[i][0].length}return f},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),t=numeric.dim(n);if(1!==e.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,c,a=e[0],f=t[0],s=Array(a);for(o=a-1;o>=0;o--){for(i=Array(f),c=r[o],u=f-1;u>=3;--u)i[u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u];for(;u>=0;)i[u]=c*n[u],--u;s[o]=i}return s},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,t,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var n,e,t,i,o,u,c,a,f,s,m,l,h,p,v,d,y,g,b=r.x.length,x=numeric.identity(b),_=numeric.rep([b,b],0),w=numeric.clone(r.x),j=numeric.clone(r.y);for(f=0;f<b;f++){for(l=(p=w[f][f])*p+(v=j[f][f])*v,m=f,s=f+1;s<b;s++)(h=(p=w[s][f])*p+(v=j[s][f])*v)>l&&(m=s,l=h);for(m!==f&&(g=w[f],w[f]=w[m],w[m]=g,g=j[f],j[f]=j[m],j[m]=g,g=x[f],x[f]=x[m],x[m]=g,g=_[f],_[f]=_[m],_[m]=g),n=w[f],e=j[f],o=x[f],u=_[f],p=n[f],v=e[f],s=f+1;s<b;s++)d=n[s],y=e[s],n[s]=(d*p+y*v)/l,e[s]=(y*p-d*v)/l;for(s=0;s<b;s++)d=o[s],y=u[s],o[s]=(d*p+y*v)/l,u[s]=(y*p-d*v)/l;for(s=f+1;s<b;s++){for(t=w[s],i=j[s],c=x[s],a=_[s],p=t[f],v=i[f],m=f+1;m<b;m++)d=n[m],y=e[m],t[m]-=d*p-y*v,i[m]-=y*p+d*v;for(m=0;m<b;m++)d=o[m],y=u[m],c[m]-=d*p-y*v,a[m]-=y*p+d*v}}for(f=b-1;f>0;f--)for(o=x[f],u=_[f],s=f-1;s>=0;s--)for(c=x[s],a=_[s],p=w[s][f],v=j[s][f],m=b-1;m>=0;m--)d=o[m],y=u[m],c[m]-=p*d-v*y,a[m]-=p*y+v*d;return new numeric.T(x,_)},numeric.T.prototype.get=function(r){var n,e=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)e=e[n=r[i]],t=t[n],i++;return new numeric.T(e,t)}for(;i<o;)e=e[n=r[i]],i++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,t=this.x,i=this.y,o=0,u=r.length,c=n.x,a=n.y;if(0===u)return a?this.y=a:i&&(this.y=void 0),this.x=t,this;if(a){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,i[e]=a,this}if(i){for(;o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,c instanceof Array?i[e]=numeric.rep(numeric.dim(c),0):i[e]=0,this}for(;o<u-1;)t=t[e=r[o]],o++;return t[e=r[o]]=c,this},numeric.T.prototype.getRows=function(r,n){var e,t,i=n-r+1,o=Array(i),u=this.x,c=this.y;for(e=r;e<=n;e++)o[e-r]=u[e];if(c){for(t=Array(i),e=r;e<=n;e++)t[e-r]=c[e];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,n,e){var t,i=this.x,o=this.y,u=e.x,c=e.y;for(t=r;t<=n;t++)i[t]=u[t-r];if(c)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=n;t++)o[t]=c[t-r];else if(o)for(t=r;t<=n;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,t=this.y,i=n.x,o=n.y;return e[r]=i,o?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(e,r,n),i(t,r,n)):new numeric.T(i(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,i=this.y,o=numeric.setBlock,u=e.x,c=e.y;if(c)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,n,u),o(i,r,n,c),this;o(t,r,n,u),i&&o(i,r,n,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var t=n.x,i=n.y,o=numeric.rep;return i?new e(o(r,t),o(r,i)):new e(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,t=numeric.diag;return e?new numeric.T(t(n),t(e)):new numeric.T(t(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(r[0]>=0?1:-1)*numeric.norm2(r);n[0]+=e;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,i,o,u,c,a,f,s,m,l=n[0],h=numeric.clone(r),p=numeric.identity(l);for(t=0;t<l-2;t++){for(o=Array(l-t-1),e=t+1;e<l;e++)o[e-t-1]=h[e][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),c=numeric.getBlock(h,[t+1,t],[l-1,l-1]),a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<l;e++)for(f=h[e],s=a[e-t-1],i=t;i<l;i++)f[i]-=2*s[i-t];for(c=numeric.getBlock(h,[0,t+1],[l-1,l-1]),a=numeric.tensor(numeric.dot(c,u),u),e=0;e<l;e++)for(f=h[e],s=a[e],i=t+1;i<l;i++)f[i]-=2*s[i-t-1];for(c=Array(l-t-1),e=t+1;e<l;e++)c[e-t-1]=p[e];for(a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<l;e++)for(m=p[e],s=a[e-t-1],i=0;i<l;i++)m[i]-=2*s[i]}}return{H:h,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r);numeric.clone(r);var e,t,i,o,u,c,a,f,s,m,l,h,p,v,d,y,g,b,x=numeric.dim(r)[0],_=numeric.identity(x);if(x<3)return{Q:_,B:[[0,x-1]]};var w=numeric.epsilon;for(b=0;b<n;b++){for(y=0;y<x-1;y++)if(Math.abs(r[y+1][y])<w*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var j=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),n),M=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[x-1,x-1]),n);for(h=Array(y+1),d=0;d<=y;d++)h[d]=_[d];for(p=numeric.dot(j.Q,h),d=0;d<=y;d++)_[d]=p[d];for(h=Array(x-y-1),d=y+1;d<x;d++)h[d-y-1]=_[d];for(p=numeric.dot(M.Q,h),d=y+1;d<x;d++)_[d]=p[d-y-1];return{Q:_,B:j.B.concat(numeric.add(M.B,y+1))}}var A,k,T;if(i=r[x-2][x-2],o=r[x-2][x-1],u=r[x-1][x-2],f=i+(c=r[x-1][x-1]),a=i*c-o*u,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*a)A=.5*(f+Math.sqrt(f*f-4*a)),k=.5*(f-Math.sqrt(f*f-4*a)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,A+k)),numeric.diag(numeric.rep([3],A*k)));else s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],a)));for(e=[s[0][0],s[1][0],s[2][0]],t=numeric.house(e),h=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,h)),d=0;d<3;d++)for(l=r[d],v=p[d],g=0;g<x;g++)l[g]-=2*v[g];for(h=numeric.getBlock(r,[0,0],[x-1,2]),p=numeric.tensor(numeric.dot(h,t),t),d=0;d<x;d++)for(l=r[d],v=p[d],g=0;g<3;g++)l[g]-=2*v[g];for(h=[_[0],_[1],_[2]],p=numeric.tensor(t,numeric.dot(t,h)),d=0;d<3;d++)for(m=_[d],v=p[d],g=0;g<x;g++)m[g]-=2*v[g];for(y=0;y<x-2;y++){for(g=y;g<=y+1;g++)if(Math.abs(r[g+1][g])<w*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){j=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),n),M=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[x-1,x-1]),n);for(h=Array(g+1),d=0;d<=g;d++)h[d]=_[d];for(p=numeric.dot(j.Q,h),d=0;d<=g;d++)_[d]=p[d];for(h=Array(x-g-1),d=g+1;d<x;d++)h[d-g-1]=_[d];for(p=numeric.dot(M.Q,h),d=g+1;d<x;d++)_[d]=p[d-g-1];return{Q:_,B:j.B.concat(numeric.add(M.B,g+1))}}for(T=Math.min(x-1,y+3),e=Array(T-y),d=y+1;d<=T;d++)e[d-y-1]=r[d][y];for(t=numeric.house(e),h=numeric.getBlock(r,[y+1,y],[T,x-1]),p=numeric.tensor(t,numeric.dot(t,h)),d=y+1;d<=T;d++)for(l=r[d],v=p[d-y-1],g=y;g<x;g++)l[g]-=2*v[g-y];for(h=numeric.getBlock(r,[0,y+1],[x-1,T]),p=numeric.tensor(numeric.dot(h,t),t),d=0;d<x;d++)for(l=r[d],v=p[d],g=y+1;g<=T;g++)l[g]-=2*v[g-y-1];for(h=Array(T-y),d=y+1;d<=T;d++)h[d-y-1]=_[d];for(p=numeric.tensor(t,numeric.dot(t,h)),d=y+1;d<=T;d++)for(m=_[d],v=p[d-y-1],g=0;g<x;g++)m[g]-=2*v[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,t,i,o,u,c,a,f,s,m,l,h,p,v,d,y,g=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(g.H,n),x=numeric.T,_=r.length,w=b.B,j=numeric.dot(b.Q,numeric.dot(g.H,numeric.transpose(b.Q))),M=new x(numeric.dot(b.Q,g.Q)),A=w.length,k=Math.sqrt;for(t=0;t<A;t++)if((e=w[t][0])===w[t][1]);else{if(o=e+1,u=j[e][e],c=j[e][o],a=j[o][e],f=j[o][o],0===c&&0===a)continue;(m=(s=-u-f)*s-4*(u*f-c*a))>=0?((d=(u-(l=s<0?-.5*(s-k(m)):-.5*(s+k(m))))*(u-l)+c*c)>(y=a*a+(f-l)*(f-l))?(p=(u-l)/(d=k(d)),v=c/d):(p=a/(y=k(y)),v=(f-l)/y),i=new x([[v,-p],[p,v]]),M.setRows(e,o,i.dot(M.getRows(e,o)))):(l=-.5*s,h=.5*k(-m),(d=(u-l)*(u-l)+c*c)>(y=a*a+(f-l)*(f-l))?(p=(u-l)/(d=k(d+h*h)),v=c/d,l=0,h/=d):(p=a/(y=k(y+h*h)),v=(f-l)/y,l=h/y,h=0),i=new x([[v,-p],[p,v]],[[l,h],[h,-l]]),M.setRows(e,o,i.dot(M.getRows(e,o))))}var T=M.dot(r).dot(M.transjugate()),S=(_=r.length,numeric.T.identity(_));for(o=0;o<_;o++)if(o>0)for(t=o-1;t>=0;t--){var O=T.get([t,t]),P=T.get([o,o]);numeric.neq(O.x,P.x)||numeric.neq(O.y,P.y)?(l=T.getRow(t).getBlock([t],[o-1]),h=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],T.get([t,o]).neg().sub(l.dot(h)).div(O.sub(P)))):S.setRow(o,S.getRow(t))}for(o=0;o<_;o++)l=S.getRow(o),S.setRow(o,l.div(l.norm2()));return S=S.transpose(),S=M.transjugate().dot(S),{lambda:T.getDiag(),E:S}},numeric.ccsSparse=function(r){var n,e,t,i=r.length,o=[];for(e=i-1;-1!==e;--e)for(t in n=r[e]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==n[t]&&o[t]++}var u=o.length,c=Array(u+1);for(c[0]=0,e=0;e<u;++e)c[e+1]=c[e]+o[e];var a=Array(c[u]),f=Array(c[u]);for(e=i-1;-1!==e;--e)for(t in n=r[e])0!==n[t]&&(o[t]--,a[c[t]+o[t]]=e,f[c[t]+o[t]]=n[t]);return[c,a,f]},numeric.ccsFull=function(r){var n,e,t,i,o=r[0],u=r[1],c=r[2],a=numeric.ccsDim(r),f=a[0],s=a[1],m=numeric.rep([f,s],0);for(n=0;n<s;n++)for(t=o[n],i=o[n+1],e=t;e<i;++e)m[u[e]][n]=c[e];return m},numeric.ccsTSolve=function(r,n,e,t,i){var o,u,c,a,f,s,m,l=r[0],h=r[1],p=r[2],v=l.length-1,d=Math.max,y=0;function g(r){var n;if(0===e[r]){for(e[r]=1,n=l[r];n<l[r+1];++n)g(h[n]);i[y]=r,++y}}for(void 0===t&&(e=numeric.rep([v],0)),void 0===t&&(t=numeric.linspace(0,e.length-1)),void 0===i&&(i=[]),o=t.length-1;-1!==o;--o)g(t[o]);for(i.length=y,o=i.length-1;-1!==o;--o)e[i[o]]=0;for(o=t.length-1;-1!==o;--o)u=t[o],e[u]=n[u];for(o=i.length-1;-1!==o;--o){for(u=i[o],c=l[u],a=d(l[u+1],c),f=c;f!==a;++f)if(h[f]===u){e[u]/=p[f];break}for(m=e[u],f=c;f!==a;++f)(s=h[f])!==u&&(e[s]-=m*p[f])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,t,i,o){var u,c,a,f=0,s=i.length,m=this.k,l=this.k1,h=this.j;if(0===t[r])for(t[r]=1,h[0]=r,m[0]=c=n[r],l[0]=a=n[r+1];;)if(c>=a){if(i[s]=h[f],0===f)return;++s,c=m[--f],a=l[f]}else 0===t[u=o[e[c]]]?(t[u]=1,m[f]=c,h[++f]=u,c=n[u],l[f]=a=n[u+1]):++c},numeric.ccsLPSolve=function(r,n,e,t,i,o,u){var c,a,f,s,m,l,h,p,v,d=r[0],y=r[1],g=r[2],b=(d.length,n[0]),x=n[1],_=n[2];for(a=b[i],f=b[i+1],t.length=0,c=a;c<f;++c)u.dfs(o[x[c]],d,y,e,t,o);for(c=t.length-1;-1!==c;--c)e[t[c]]=0;for(c=a;c!==f;++c)e[s=o[x[c]]]=_[c];for(c=t.length-1;-1!==c;--c){for(m=d[s=t[c]],l=d[s+1],h=m;h<l;++h)if(o[y[h]]===s){e[s]/=g[h];break}for(v=e[s],h=m;h<l;++h)(p=o[y[h]])!==s&&(e[p]-=v*g[h])}return e},numeric.ccsLUP1=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],l=s[0],h=s[1],p=s[2],v=m[0],d=m[1],y=m[2],g=numeric.rep([f],0),b=numeric.rep([f],0),x=numeric.ccsLPSolve,_=(Math.max,Math.abs),w=numeric.linspace(0,f-1),j=numeric.linspace(0,f-1),M=new numeric.ccsDFS(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(x(s,r,g,b,e,j,M),o=-1,u=-1,t=b.length-1;-1!==t;--t)(i=b[t])<=e||(c=_(g[i]))>o&&(u=i,o=c);for(_(g[e])<n*o&&(t=w[e],o=w[u],w[e]=o,j[o]=e,w[u]=t,j[t]=u,o=g[e],g[e]=g[u],g[u]=o),o=l[e],u=v[e],a=g[e],h[o]=w[e],p[o]=1,++o,t=b.length-1;-1!==t;--t)c=g[i=b[t]],b[t]=0,g[i]=0,i<=e?(d[u]=i,y[u]=c,++u):(h[o]=w[i],p[o]=c/a,++o);l[e+1]=o,v[e+1]=u}for(t=h.length-1;-1!==t;--t)h[t]=j[h[t]];return{L:s,U:m,P:w,Pinv:j}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,t,i,o,u){var c,a,f,s=0,m=i.length,l=this.k,h=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,l[0]=a=n[o[r]],h[0]=f=n[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=f){if(i[m]=o[p[s]],0===s)return;++m,a=l[--s],f=h[s]}else 0===t[c=e[a]]?(t[c]=1,l[s]=a,p[++s]=c,a=n[c=o[c]],h[s]=f=n[c+1]):++a}},numeric.ccsLPSolve0=function(r,n,e,t,i,o,u,c){var a,f,s,m,l,h,p,v,d,y=r[0],g=r[1],b=r[2],x=(y.length,n[0]),_=n[1],w=n[2];for(f=x[i],s=x[i+1],t.length=0,a=f;a<s;++a)c.dfs(_[a],y,g,e,t,o,u);for(a=t.length-1;-1!==a;--a)e[u[m=t[a]]]=0;for(a=f;a!==s;++a)e[m=_[a]]=w[a];for(a=t.length-1;-1!==a;--a){for(v=u[m=t[a]],l=y[m],h=y[m+1],p=l;p<h;++p)if(g[p]===v){e[v]/=b[p];break}for(d=e[v],p=l;p<h;++p)e[g[p]]-=d*b[p];e[v]=d}},numeric.ccsLUP0=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],l=s[0],h=s[1],p=s[2],v=m[0],d=m[1],y=m[2],g=numeric.rep([f],0),b=numeric.rep([f],0),x=numeric.ccsLPSolve0,_=(Math.max,Math.abs),w=numeric.linspace(0,f-1),j=numeric.linspace(0,f-1),M=new numeric.ccsDFS0(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(x(s,r,g,b,e,j,w,M),o=-1,u=-1,t=b.length-1;-1!==t;--t)(i=b[t])<=e||(c=_(g[w[i]]))>o&&(u=i,o=c);for(_(g[w[e]])<n*o&&(t=w[e],o=w[u],w[e]=o,j[o]=e,w[u]=t,j[t]=u),o=l[e],u=v[e],a=g[w[e]],h[o]=w[e],p[o]=1,++o,t=b.length-1;-1!==t;--t)c=g[w[i=b[t]]],b[t]=0,g[w[i]]=0,i<=e?(d[u]=i,y[u]=c,++u):(h[o]=w[i],p[o]=c/a,++o);l[e+1]=o,v[e+1]=u}for(t=h.length-1;-1!==t;--t)h[t]=j[h[t]];return{L:s,U:m,P:w,Pinv:j}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var t=numeric.ccsDim(r),i=t[0],o=t[1];void 0===n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]),void 0===e?e=numeric.linspace(0,o-1):"number"==typeof e&&(e=[e]);var u,c,a,f,s=n.length,m=e.length,l=numeric.rep([o],0),h=[],p=[],v=[l,h,p],d=r[0],y=r[1],g=r[2],b=numeric.rep([i],0),x=0,_=numeric.rep([i],0);for(c=0;c<m;++c){var w=d[f=e[c]],j=d[f+1];for(u=w;u<j;++u)_[a=y[u]]=1,b[a]=g[u];for(u=0;u<s;++u)_[n[u]]&&(h[x]=u,p[x]=b[n[u]],++x);for(u=w;u<j;++u)_[a=y[u]]=0;l[c+1]=x}return v},numeric.ccsDot=function(r,n){var e,t,i,o,u,c,a,f,s,m,l,h=r[0],p=r[1],v=r[2],d=n[0],y=n[1],g=n[2],b=numeric.ccsDim(r),x=numeric.ccsDim(n),_=b[0],w=(b[1],x[1]),j=numeric.rep([_],0),M=numeric.rep([_],0),A=Array(_),k=numeric.rep([w],0),T=[],S=[],O=[k,T,S];for(i=0;i!==w;++i){for(o=d[i],u=d[i+1],s=0,t=o;t<u;++t)for(m=y[t],l=g[t],c=h[m],a=h[m+1],e=c;e<a;++e)0===M[f=p[e]]&&(A[s]=f,M[f]=1,s+=1),j[f]=j[f]+v[e]*l;for(u=(o=k[i])+s,k[i+1]=u,t=s-1;-1!==t;--t)l=o+t,e=A[t],T[l]=e,S[l]=j[e],M[e]=0,j[e]=0;k[i+1]=k[i]+s}return O},numeric.ccsLUPSolve=function(r,n){var e=r.L,t=r.U,i=(r.P,n[0]),o=!1;"object"!=typeof i&&(i=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],o=!0);var u,c,a,f,s,m,l=n[1],h=n[2],p=e[0].length-1,v=i.length-1,d=numeric.rep([p],0),y=Array(p),g=numeric.rep([p],0),b=Array(p),x=numeric.rep([v+1],0),_=[],w=[],j=numeric.ccsTSolve,M=0;for(u=0;u<v;++u){for(s=0,a=i[u],f=i[u+1],c=a;c<f;++c)m=r.Pinv[l[c]],b[s]=m,g[m]=h[c],++s;for(b.length=s,j(e,g,d,b,y),c=b.length-1;-1!==c;--c)g[b[c]]=0;if(j(t,d,g,y,b),o)return g;for(c=y.length-1;-1!==c;--c)d[y[c]]=0;for(c=b.length-1;-1!==c;--c)m=b[c],_[M]=m,w[M]=g[m],g[m]=0,++M;x[u+1]=M}return[x,_,w]},numeric.ccsbinop=function(r,n){return void 0===n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=e.length,c=numeric.rep([o],0),a=Array(u),f=Array(u),s=numeric.rep([o],0);for(n=0;n<u;++n)s[t[n]]++;for(n=0;n<o;++n)c[n+1]=c[n]+s[n];var m,l,h=c.slice(0);for(n=0;n<u;++n)a[m=h[l=t[n]]]=e[n],f[m]=i[n],h[l]=h[l]+1;return[c,a,f]},numeric.ccsGather=function(r){var n,e,t,i,o,u=r[0],c=r[1],a=r[2],f=u.length-1,s=c.length,m=Array(s),l=Array(s),h=Array(s);for(o=0,n=0;n<f;++n)for(t=u[n],i=u[n+1],e=t;e!==i;++e)l[o]=n,m[o]=c[e],h[o]=a[e],++o;return[m,l,h]},numeric.sdim=function r(n,e,t){if(void 0===e&&(e=[]),"object"!=typeof n)return e;var i;for(i in void 0===t&&(t=0),t in e||(e[t]=0),n.length>e[t]&&(e[t]=n.length),n)n.hasOwnProperty(i)&&r(n[i],e,t+1);return e},numeric.sclone=function r(n,e,t){void 0===e&&(e=0),void 0===t&&(t=numeric.sdim(n).length);var i,o=Array(n.length);if(e===t-1){for(i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return o}for(i in n)n.hasOwnProperty(i)&&(o[i]=r(n[i],e+1,t));return o},numeric.sdiag=function(r){var n,e,t=r.length,i=Array(t);for(n=t-1;n>=1;n-=2)e=n-1,i[n]=[],i[n][n]=r[n],i[e]=[],i[e][e]=r[e];return 0===n&&(i[0]=[],i[0][0]=r[n]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,t,i=[];r.length;for(n in r)if(r.hasOwnProperty(n))for(e in t=r[n])t.hasOwnProperty(e)&&("object"!=typeof i[e]&&(i[e]=[]),i[e][n]=t[e]);return i},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,t,i,o,u,c,a,f=r.length,s=(n.length,numeric.stranspose(n)),m=s.length,l=Array(f);for(i=f-1;i>=0;i--){for(a=[],e=r[i],u=m-1;u>=0;u--){for(o in c=0,t=s[u],e)e.hasOwnProperty(o)&&o in t&&(c+=e[o]*t[o]);c&&(a[u]=c)}l[i]=a}return l},numeric.sdotMV=function(r,n){var e,t,i,o,u=r.length,c=Array(u);for(t=u-1;t>=0;t--){for(i in o=0,e=r[t])e.hasOwnProperty(i)&&n[i]&&(o+=e[i]*n[i]);o&&(c[t]=o)}return c},numeric.sdotVM=function(r,n){var e,t,i,o,u=[];for(e in r)if(r.hasOwnProperty(e))for(t in i=n[e],o=r[e],i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t]);return u},numeric.sdotVV=function(r,n){var e,t=0;for(e in r)r[e]&&n[e]&&(t+=r[e]*n[e]);return t},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,t=numeric.sdim(n).length;switch(1e3*e+t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(r){var n,e,t,i,o=r[0].length,u=r.length,c=[];for(e=o-1;e>=0;--e)if(r[u-1][e]){for(i=c,t=0;t<u-2;t++)i[n=r[t][e]]||(i[n]=[]),i=i[n];i[r[t][e]]=r[t+1][e]}return c},numeric.sgather=function r(n,e,t){var i,o,u;for(o in void 0===e&&(e=[]),void 0===t&&(t=[]),i=t.length,n)if(n.hasOwnProperty(o))if(t[i]=parseInt(o),"number"==typeof(u=n[o])){if(u){if(0===e.length)for(o=i+1;o>=0;--o)e[o]=[];for(o=i;o>=0;--o)e[o].push(t[o]);e[i+1].push(u)}}else r(u,e,t);return t.length>i&&t.pop(),e},numeric.cLU=function(r){var n,e,t,i,o,u,c=r[0],a=r[1],f=r[2],s=c.length,m=0;for(n=0;n<s;n++)c[n]>m&&(m=c[n]);m++;var l,h=Array(m),p=Array(m),v=numeric.rep([m],1/0),d=numeric.rep([m],-1/0);for(t=0;t<s;t++)n=c[t],(e=a[t])<v[n]&&(v[n]=e),e>d[n]&&(d[n]=e);for(n=0;n<m-1;n++)d[n]>d[n+1]&&(d[n+1]=d[n]);for(n=m-1;n>=1;n--)v[n]<v[n-1]&&(v[n-1]=v[n]);for(n=0;n<m;n++)p[n]=numeric.rep([d[n]-v[n]+1],0),h[n]=numeric.rep([n-v[n]],0),n-v[n]+1,d[n]-n+1;for(t=0;t<s;t++)p[n=c[t]][a[t]-v[n]]=f[t];for(n=0;n<m-1;n++)for(i=n-v[n],b=p[n],e=n+1;v[e]<=n&&e<m;e++)if(o=n-v[e],u=d[n]-n,l=(x=p[e])[o]/b[i]){for(t=1;t<=u;t++)x[t+o]-=l*b[t+i];h[e][n-v[e]]=l}var y,g,b=[],x=[],_=[],w=[],j=[],M=[];for(s=0,y=0,n=0;n<m;n++){for(i=v[n],o=d[n],g=p[n],e=n;e<=o;e++)g[e-i]&&(b[s]=n,x[s]=e,_[s]=g[e-i],s++);for(g=h[n],e=i;e<n;e++)g[e-i]&&(w[y]=n,j[y]=e,M[y]=g[e-i],y++);w[y]=n,j[y]=n,M[y]=1,y++}return{U:[b,x,_],L:[w,j,M]}},numeric.cLUsolve=function(r,n){var e,t,i=r.L,o=r.U,u=numeric.clone(n),c=i[0],a=i[1],f=i[2],s=o[0],m=o[1],l=o[2],h=s.length,p=(c.length,u.length);for(t=0,e=0;e<p;e++){for(;a[t]<e;)u[e]-=f[t]*u[a[t]],t++;t++}for(t=h-1,e=p-1;e>=0;e--){for(;m[t]>e;)u[e]-=l[t]*u[m[t]],t--;u[e]/=l[t],t--}return u},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var e,t,i,o=numeric.rep(r,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(r,n){return!0}}for(i=0,e=1;e<r[0]-1;e++)for(t=1;t<r[1]-1;t++)n(e,t)&&(o[e][t]=i,i++);return o},numeric.cdelsq=function(r){var n,e,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(r),a=c[0],f=c[1],s=[],m=[],l=[];for(n=1;n<a-1;n++)for(e=1;e<f-1;e++)if(!(r[n][e]<0)){for(t=0;t<4;t++)i=n+u[t][0],o=e+u[t][1],r[i][o]<0||(s.push(r[n][e]),m.push(r[i][o]),l.push(-1));s.push(r[n][e]),m.push(r[n][e]),l.push(4)}return[s,m,l]},numeric.cdotMV=function(r,n){var e,t,i,o=r[0],u=r[1],c=r[2],a=o.length;for(i=0,t=0;t<a;t++)o[t]>i&&(i=o[t]);for(i++,e=numeric.rep([i],0),t=0;t<a;t++)e[o[t]]+=c[t]*n[u[t]];return e},numeric.Spline=function(r,n,e,t,i){this.x=r,this.yl=n,this.yr=e,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,n){var e,t,i,o=this.x,u=this.yl,c=this.yr,a=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,l=numeric.mul;e=m(l(a[n],o[n+1]-o[n]),m(c[n+1],u[n])),t=s(l(f[n+1],o[n]-o[n+1]),m(c[n+1],u[n]));var h=(i=(r-o[n])/(o[n+1]-o[n]))*(1-i);return s(s(s(l(1-i,u[n]),l(i,c[n+1])),l(e,h*(1-i))),l(t,h*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var n,e,t,i=this.x,o=i.length,u=Math.floor;for(n=0,e=o-1;e-n>1;)i[t=u((n+e)/2)]<=r?n=t:e=t;return this._at(r,n)}o=r.length;var c,a=Array(o);for(c=o-1;-1!==c;--c)a[c]=this.at(r[c]);return a},numeric.Spline.prototype.diff=function(){var r,n,e,t=this.x,i=this.yl,o=this.yr,u=this.kl,c=this.kr,a=i.length,f=u,s=c,m=Array(a),l=Array(a),h=numeric.add,p=numeric.mul,v=numeric.div,d=numeric.sub;for(r=a-1;-1!==r;--r)n=t[r+1]-t[r],e=d(o[r+1],i[r]),m[r]=v(h(p(e,6),p(u[r],-4*n),p(c[r+1],-2*n)),n*n),l[r+1]=v(h(p(e,-6),p(u[r],2*n),p(c[r+1],4*n)),n*n);return new numeric.Spline(t,f,s,m,l)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var c,a,f,s,m,l,h,p,v,d,y,g,b,x,_,w,j,M,A,k,T,S,O,P=t.length,V=e.length-1,q=(n=Array(P),Math.sqrt);for(c=0;c!==P;++c){for(s=t[c],m=i[c],l=o[c],h=u[c],p=[],a=0;a!==V;a++){for(a>0&&m[a]*s[a]<0&&p.push(e[a]),w=e[a+1]-e[a],e[a],y=s[a],g=m[a+1],v=l[a]/w,b=(d=h[a+1]/w)+3*y+2*v-3*g,x=3*(d+v+2*(y-g)),(_=r(v-d+3*(y-g))+12*d*y)<=0?j=(M=b/x)>e[a]&&M<e[a+1]?[e[a],M,e[a+1]]:[e[a],e[a+1]]:(M=(b-q(_))/x,A=(b+q(_))/x,j=[e[a]],M>e[a]&&M<e[a+1]&&j.push(M),A>e[a]&&A<e[a+1]&&j.push(A),j.push(e[a+1])),T=j[0],M=this._at(T,a),f=0;f<j.length-1;f++)if(S=j[f+1],A=this._at(S,a),0!==M)if(0===A||M*A>0)T=S,M=A;else{for(var F=0;!((O=(M*S-A*T)/(M-A))<=T||O>=S);)if((k=this._at(O,a))*A>0)S=O,A=k,-1===F&&(M*=.5),F=-1;else{if(!(k*M>0))break;T=O,M=k,1===F&&(A*=.5),F=1}p.push(O),T=j[f+1],M=this._at(T,a)}else p.push(T),T=S,M=A;0===A&&p.push(S)}n[c]=p}return"number"==typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,t){var i,o=r.length,u=[],c=[],a=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=o-2;i>=0;i--)c[i]=r[i+1]-r[i],a[i]=f(n[i+1],n[i]);"string"!=typeof e&&"string"!=typeof t||(e=t="periodic");var l=[[],[],[]];switch(typeof e){case"undefined":u[0]=s(3/(c[0]*c[0]),a[0]),l[0].push(0,0),l[1].push(0,1),l[2].push(2/c[0],1/c[0]);break;case"string":u[0]=m(s(3/(c[o-2]*c[o-2]),a[o-2]),s(3/(c[0]*c[0]),a[0])),l[0].push(0,0,0),l[1].push(o-2,0,1),l[2].push(1/c[o-2],2/c[o-2]+2/c[0],1/c[0]);break;default:u[0]=e,l[0].push(0),l[1].push(0),l[2].push(1)}for(i=1;i<o-1;i++)u[i]=m(s(3/(c[i-1]*c[i-1]),a[i-1]),s(3/(c[i]*c[i]),a[i])),l[0].push(i,i,i),l[1].push(i-1,i,i+1),l[2].push(1/c[i-1],2/c[i-1]+2/c[i],1/c[i]);switch(typeof t){case"undefined":u[o-1]=s(3/(c[o-2]*c[o-2]),a[o-2]),l[0].push(o-1,o-1),l[1].push(o-2,o-1),l[2].push(1/c[o-2],2/c[o-2]);break;case"string":l[1][l[1].length-1]=0;break;default:u[o-1]=t,l[0].push(o-1),l[1].push(o-1),l[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var h=Array(u.length);if("string"==typeof e)for(i=h.length-1;-1!==i;--i)h[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(l)),u[i]),h[i][o-1]=h[i][0];else for(i=h.length-1;-1!==i;--i)h[i]=numeric.cLUsolve(numeric.cLU(l),u[i]);return h="number"==typeof n[0]?h[0]:numeric.transpose(h),new numeric.Spline(r,n,n,h,h)},numeric.fftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var l,h,p,v=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),h=u(l=v*i),p=c(l),n[i]=a[o]+h*s[o]-p*m[o],e[i]=f[o]+h*m[o]+p*s[o]}},numeric._ifftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var l,h,p,v=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),h=u(l=v*i),p=c(l),n[i]=a[o]+h*s[o]-p*m[o],e[i]=f[o]+h*m[o]+p*s[o]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,t){var i,o,u,c,a;for(numeric.fftpow2(r,n),numeric.fftpow2(e,t),i=r.length-1;-1!==i;--i)o=r[i],c=n[i],u=e[i],a=t[i],r[i]=o*u-c*a,n[i]=o*a+c*u;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,l=Math.sin,h=-3.141592653589793/i,p=numeric.rep([a],0),v=numeric.rep([a],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)v[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=h*r*r,f[r]=m(n),s[r]=l(n),f[a-r]=m(n),s[a-r]=l(n);var d=new numeric.T(p,v),y=new numeric.T(f,s);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d},numeric.T.prototype.ifft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,l=Math.sin,h=3.141592653589793/i,p=numeric.rep([a],0),v=numeric.rep([a],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if(void 0!==t)for(r=0;r<i;r++)v[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=h*r*r,f[r]=m(n),s[r]=l(n),f[a-r]=m(n),s[a-r]=l(n);var d=new numeric.T(p,v),y=new numeric.T(f,s);return d=d.mul(y),numeric.convpow2(d.x,d.y,numeric.clone(y.x),numeric.neg(y.y)),(d=d.mul(y)).x.length=i,d.y.length=i,d.div(i)},numeric.gradient=function(r,n){var e=n.length,t=r(n);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,c,a,f,s,m,l,h=Math.max,p=numeric.clone(n),v=Array(e),d=(numeric.div,numeric.sub,h=Math.max,Math.abs),y=Math.min,g=0;for(i=0;i<e;i++)for(var b=h(1e-6*t,1e-8);;){if(++g>20)throw new Error("Numerical gradient fails");if(p[i]=n[i]+b,o=r(p),p[i]=n[i]-b,u=r(p),p[i]=n[i],isNaN(o)||isNaN(u))b/=16;else{if(v[i]=(o-u)/(2*b),c=n[i]-b,a=n[i],f=n[i]+b,s=(o-t)/b,m=(t-u)/b,l=h(d(v[i]),d(t),d(o),d(u),d(c),d(a),d(f),1e-8),!(y(h(d(s-v[i]),d(m-v[i]),d(s-m))/l,b/l)>.001))break;b/=16}}return v},numeric.uncmin=function(r,n,e,t,i,o,u){var c=numeric.gradient;void 0===u&&(u={}),void 0===e&&(e=1e-8),void 0===t&&(t=function(n){return c(r,n)}),void 0===i&&(i=1e3);var a,f,s=(n=numeric.clone(n)).length,m=r(n);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var l=Math.max,h=numeric.norm2;e=l(e,numeric.epsilon);var p,v,d,y,g,b,x,_,w,j,M=u.Hinv||numeric.identity(s),A=numeric.dot,k=(numeric.inv,numeric.sub),T=numeric.add,S=numeric.tensor,O=numeric.div,P=numeric.mul,V=numeric.all,q=numeric.isFinite,F=numeric.neg,E=0,L="";for(v=t(n);E<i;){if("function"==typeof o&&o(E,n,m,v,M)){L="Callback returned true";break}if(!V(q(v))){L="Gradient has Infinity or NaN";break}if(!V(q(p=F(A(M,v))))){L="Search direction has Infinity or NaN";break}if((j=h(p))<e){L="Newton step smaller than tol";break}for(w=1,f=A(v,p),g=n;E<i&&!(w*j<e)&&(g=T(n,y=P(p,w)),(a=r(g))-m>=.1*w*f||isNaN(a));)w*=.5,++E;if(w*j<e){L="Line search step size smaller than tol";break}if(E===i){L="maxit reached during line search";break}_=A(b=k(d=t(g),v),y),x=A(M,b),M=k(T(M,P((_+A(b,x))/(_*_),S(y,y))),O(T(S(x,y),S(y,x)),_)),n=g,m=a,v=d,++E}return{solution:n,f:m,gradient:v,invHessian:M,iterations:E,message:L}},numeric.Dopri=function(r,n,e,t,i,o,u){this.x=r,this.y=n,this.f=e,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var t,i,o,u,c,a,f,s,m,l=this.x,h=this.y,p=this.f,v=this.ymid,d=(l.length,Math.floor,numeric.add),y=numeric.mul,g=numeric.sub;return t=l[n],i=l[n+1],u=h[n],c=h[n+1],o=t+.5*(i-t),a=v[n],f=g(p[n],y(u,1/(t-o)+2/(t-i))),s=g(p[n+1],y(c,1/(i-o)+2/(i-t))),d(d(d(d(y(u,(m=[e(r-i)*(r-o)/e(t-i)/(t-o),e(r-t)*e(r-i)/e(t-o)/e(i-o),e(r-t)*(r-o)/e(i-t)/(i-o),(r-t)*e(r-i)*(r-o)/e(t-i)/(t-o),(r-i)*e(r-t)*(r-o)/e(t-i)/(i-o)])[0]),y(a,m[1])),y(c,m[2])),y(f,m[3])),y(s,m[4]))},numeric.Dopri.prototype.at=function(r){var n,e,t,i=Math.floor;if("number"!=typeof r){var o=r.length,u=Array(o);for(n=o-1;-1!==n;--n)u[n]=this.at(r[n]);return u}var c=this.x;for(n=0,e=c.length-1;e-n>1;)c[t=i(.5*(n+e))]<=r?n=t:e=t;return this._at(r,n)},numeric.dopri=function(r,n,e,t,i,o,u){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var c,a,f,s,m,l,h,p,v,d,y,g,b,x=[r],_=[e],w=[t(r,e)],j=[],M=[.075,.225],A=[44/45,-56/15,32/9],k=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],O=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],P=[.2,.3,.8,8/9,1,1],V=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],q=0,F=(n-r)/10,E=0,L=numeric.add,N=numeric.mul,D=(Math.max,Math.min),U=Math.abs,B=numeric.norminf,R=Math.pow,C=numeric.any,I=numeric.lt,X=numeric.and,Y=(numeric.sub,new numeric.Dopri(x,_,w,j,-1,""));for("function"==typeof u&&(y=u(r,e));r<n&&E<o;)if(++E,r+F>n&&(F=n-r),c=t(r+P[0]*F,L(e,N(.2*F,w[q]))),a=t(r+P[1]*F,L(L(e,N(M[0]*F,w[q])),N(M[1]*F,c))),f=t(r+P[2]*F,L(L(L(e,N(A[0]*F,w[q])),N(A[1]*F,c)),N(A[2]*F,a))),s=t(r+P[3]*F,L(L(L(L(e,N(k[0]*F,w[q])),N(k[1]*F,c)),N(k[2]*F,a)),N(k[3]*F,f))),m=t(r+P[4]*F,L(L(L(L(L(e,N(T[0]*F,w[q])),N(T[1]*F,c)),N(T[2]*F,a)),N(T[3]*F,f)),N(T[4]*F,s))),l=t(r+F,v=L(L(L(L(L(e,N(w[q],F*S[0])),N(a,F*S[2])),N(f,F*S[3])),N(s,F*S[4])),N(m,F*S[5]))),(d="number"==typeof(h=L(L(L(L(L(N(w[q],F*V[0]),N(a,F*V[2])),N(f,F*V[3])),N(s,F*V[4])),N(m,F*V[5])),N(l,F*V[6])))?U(h):B(h))>i){if(r+(F=.2*F*R(i/d,.25))===r){Y.msg="Step size became too small";break}}else{if(j[q]=L(L(L(L(L(L(e,N(w[q],F*O[0])),N(a,F*O[2])),N(f,F*O[3])),N(s,F*O[4])),N(m,F*O[5])),N(l,F*O[6])),x[++q]=r+F,_[q]=v,w[q]=l,"function"==typeof u){var $,Q,z=r,Z=r+.5*F;if(g=u(Z,j[q-1]),C(b=X(I(y,0),I(0,g)))||(z=Z,y=g,g=u(Z=r+F,v),b=X(I(y,0),I(0,g))),C(b)){for(var G,H,W=0,J=1,K=1;;){if("number"==typeof y)Q=(K*g*z-J*y*Z)/(K*g-J*y);else for(Q=Z,p=y.length-1;-1!==p;--p)y[p]<0&&g[p]>0&&(Q=D(Q,(K*g[p]*z-J*y[p]*Z)/(K*g[p]-J*y[p])));if(Q<=z||Q>=Z)break;H=u(Q,$=Y._at(Q,q-1)),C(G=X(I(y,0),I(0,H)))?(Z=Q,g=H,b=G,K=1,-1===W?J*=.5:J=1,W=-1):(z=Q,y=H,J=1,1===W?K*=.5:K=1,W=1)}return v=Y._at(.5*(r+Q),q-1),Y.f[q]=t(Q,$),Y.x[q]=Q,Y.y[q]=$,Y.ymid[q-1]=v,Y.events=b,Y.iterations=E,Y}}r+=F,e=v,y=g,F=D(.8*F*R(i/d,.25),4*F)}return Y.iterations=E,Y},numeric.LU=function(r,n){n=n||!1;var e,t,i,o,u,c,a,f,s,m=Math.abs,l=r.length,h=l-1,p=new Array(l);for(n||(r=numeric.clone(r)),i=0;i<l;++i){for(a=i,s=m((c=r[i])[i]),t=i+1;t<l;++t)s<(o=m(r[t][i]))&&(s=o,a=t);for(p[i]=a,a!=i&&(r[i]=r[a],r[a]=c,c=r[i]),u=c[i],e=i+1;e<l;++e)r[e][i]/=u;for(e=i+1;e<l;++e){for(f=r[e],t=i+1;t<h;++t)f[t]-=f[i]*c[t],f[++t]-=f[i]*c[t];t===h&&(f[t]-=f[i]*c[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){var e,t,i,o,u,c=r.LU,a=c.length,f=numeric.clone(n),s=r.P;for(e=a-1;-1!==e;--e)f[e]=n[e];for(e=0;e<a;++e)for(i=s[e],s[e]!==e&&(u=f[e],f[e]=f[i],f[i]=u),o=c[e],t=0;t<e;++t)f[e]-=f[t]*o[t];for(e=a-1;e>=0;--e){for(o=c[e],t=e+1;t<a;++t)f[e]-=f[t]*o[t];f[e]/=o[e]}return f},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,t,i,o,u,c,a,f=numeric.dim(r),s=f[0],m=f[1],l=numeric.identity(s),h=Array(s),p=Math.abs,v=numeric.diveq;for(r=numeric.clone(r),n=0;n<s;++n){for(t=0,o=r[n],u=l[n],e=1;e<m;++e)p(o[t])<p(o[e])&&(t=e);for(h[n]=t,v(u,o[t]),v(o,o[t]),e=0;e<s;++e)if(e!==n){for(a=(c=r[e])[t],i=m-1;-1!==i;--i)c[i]-=o[i]*a;for(c=l[e],i=s-1;-1!==i;--i)c[i]-=u[i]*a}}return{I:l,A:r,P:h}},numeric.__solveLP=function(r,n,e,t,i,o,u){var c,a,f,s,m=numeric.sum,l=(numeric.log,numeric.mul),h=numeric.sub,p=numeric.dot,v=numeric.div,d=numeric.add,y=r.length,g=e.length,b=!1,x=1,_=(numeric.transpose(n),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),j=Math.abs,M=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,k=numeric.gt,T=Array(y),S=Array(g),O=(numeric.rep([g],1),numeric.solve),P=h(e,p(n,o)),V=p(r,r);for(f=0;f<i;++f){var q,F;for(q=g-1;-1!==q;--q)S[q]=v(n[q],P[q]);var E=_(S);for(q=y-1;-1!==q;--q)T[q]=m(E[q]);x=.25*j(V/p(r,T));var L=100*w(V/p(T,T));for((!isFinite(x)||x>L)&&(x=L),s=d(r,l(x,T)),a=p(E,S),q=y-1;-1!==q;--q)a[q][q]+=1;F=O(a,v(s,x),!0);var N=v(P,p(n,F)),D=1;for(q=g-1;-1!==q;--q)N[q]<0&&(D=M(D,-.999*N[q]));if(c=h(o,l(F,D)),!A(k(P=h(e,p(n,c)),0)))return{solution:o,message:"",iterations:f};if(o=c,x<t)return{solution:c,message:"",iterations:f};if(u){var U=p(r,s),B=p(n,s);for(b=!0,q=g-1;-1!==q;--q)if(U*B[q]<0){b=!1;break}}else b=!(o[y-1]>=0);if(b)return{solution:c,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,n,e,t,i){var o=r.length,u=e.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([u,1],-1),m=numeric.blockMatrix([[n,s]]),l=e,h=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),p=numeric.__solveLP(f,m,l,t,i,h,!1),v=numeric.clone(p.solution);if(v.length=o,numeric.inf(c(e,a(n,v)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var d=numeric.__solveLP(r,n,e,t,i-p.iterations,v,!0);return d.iterations+=p.iterations,d},numeric.solveLP=function(r,n,e,t,i,o,u){if(void 0===u&&(u=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(r,n,e,o,u);var c,a=t.length,f=t[0].length,s=n.length,m=numeric.echelonize(t),l=numeric.rep([f],0),h=m.P,p=[];for(c=h.length-1;-1!==c;--c)l[h[c]]=1;for(c=f-1;-1!==c;--c)0===l[c]&&p.push(c);var v=numeric.getRange,d=numeric.linspace(0,a-1),y=numeric.linspace(0,s-1),g=v(t,d,p),b=v(n,y,h),x=v(n,y,p),_=numeric.dot,w=numeric.sub,j=_(b,m.I),M=w(x,_(j,g)),A=w(e,_(j,i)),k=Array(h.length),T=Array(p.length);for(c=h.length-1;-1!==c;--c)k[c]=r[h[c]];for(c=p.length-1;-1!==c;--c)T[c]=r[p[c]];var S=w(T,_(k,_(m.I,g))),O=numeric._solveLP(S,M,A,o,u),P=O.solution;if(P!=P)return O;var V=_(m.I,w(i,_(g,P))),q=Array(r.length);for(c=h.length-1;-1!==c;--c)q[h[c]]=V[c];for(c=p.length-1;-1!==c;--c)q[p[c]]=P[c];return{solution:q,message:O.message,iterations:O.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var n,e,t,i,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=r.length,a=0,f={},s=[],m=0,l={},h=0,p=[],v=[],d=[];function y(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+u[o]+"\n")}for(n=0;n<c;++n){var g=(t=r[n]).match(/\S*/g),b=[];for(e=0;e<g.length;++e)""!==g[e]&&b.push(g[e]);if(0!==b.length){for(e=0;e<u.length&&t.substr(0,u[e].length)!==u[e];++e);if(e<u.length){if(o=e,1===e&&(i=b[1]),6===e)return{name:i,c:p,A:numeric.transpose(v),b:d,rows:f,vars:l}}else switch(o){case 0:case 1:y("Unexpected line");case 2:switch(b[0]){case"N":0===a?a=b[1]:y("Two or more N rows");break;case"L":f[b[1]]=m,s[m]=1,d[m]=0,++m;break;case"G":f[b[1]]=m,s[m]=-1,d[m]=0,++m;break;case"E":f[b[1]]=m,s[m]=0,d[m]=0,++m;break;default:y("Parse error "+numeric.prettyPrint(b))}break;case 3:l.hasOwnProperty(b[0])||(l[b[0]]=h,p[h]=0,v[h]=numeric.rep([m],0),++h);var x=l[b[0]];for(e=1;e<b.length;e+=2)if(b[e]!==a){var _=f[b[e]];v[x][_]=(s[_]<0?-1:1)*parseFloat(b[e+1])}else p[x]=parseFloat(b[e+1]);break;case 4:for(e=1;e<b.length;e+=2)d[f[b[e]]]=(s[f[b[e]]]<0?-1:1)*parseFloat(b[e+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,t,i,o,u){function c(r){var n,t,i=this,o=r.length,u=0,c=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);u<e;)i.S[u]=u++;for(u=0;u<e;u++)c=s(c+(n=i.S[u])+r[u%o]),t=i.S[c],i.S[u]=t,i.S[c]=n;i.g=function(r){var n=i.S,t=s(i.i+1),o=n[t],u=s(i.j+o),c=n[u];n[t]=c,n[u]=o;for(var a=n[s(o+c)];--r;)t=s(t+1),c=n[u=s(u+(o=n[t]))],n[t]=c,n[u]=o,a=a*e+n[s(o+c)];return i.i=t,i.j=u,a},i.g(e)}function a(r,n,e,t,i){if(e=[],i=typeof r,n&&"object"==i)for(t in r)if(t.indexOf("S")<5)try{e.push(a(r[t],n-1))}catch(r){}return e.length?e:r+("string"!=i?"\0":"")}function f(r,n,e,t){for(r+="",e=0,t=0;t<r.length;t++)n[s(t)]=s((e^=19*n[s(t)])+r.charCodeAt(t));for(t in r="",n)r+=String.fromCharCode(n[t]);return r}function s(r){return r&e-1}n.seedrandom=function(t,s){var m,l=[];return t=f(a(s?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),l),f((m=new c(l)).S,r),n.random=function(){for(var r=m.g(6),n=u,t=0;r<i;)r=(r+t)*e,n*=e,t=m.g(1);for(;r>=o;)r/=2,n/=2,t>>>=1;return(r+t)/n},t},u=n.pow(e,6),i=n.pow(2,i),o=2*i,f(n.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=0;e<i;e++)t[e+1]=n(r[e]);return t}function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=1;n<i;n++)t[n-1]=e(r[n]);return t}function t(r,n,e,t,i,o,u,c,a,f,s,m,l,h,p,v){var d,y,g,b,x,_,w,j,M,A,k,T,S,O,P,V,q,F,E,L,N,D,U,B,R,C,I;S=Math.min(t,f),g=2*t+S*(S+5)/2+2*f+1,B=1e-60;do{R=1+.1*(B+=B),C=1+.2*B}while(R<=1||C<=1);for(d=1;d<=t;d+=1)p[d]=n[d];for(d=t+1;d<=g;d+=1)p[d]=0;for(d=1;d<=f;d+=1)m[d]=0;if(x=[],0===v[1]){if(function(r,n,e,t){var i,o,u,c,a,f;for(o=1;o<=e;o+=1){if(t[1]=o,f=0,(u=o-1)<1){if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}else{for(c=1;c<=u;c+=1){for(a=r[c][o],i=1;i<c;i+=1)a-=r[i][o]*r[i][c];a/=r[c][c],r[c][o]=a,f+=a*a}if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}t[1]=0}}(r,0,t,x),0!==x[1])return void(v[1]=2);!function(r,n,e,t){var i,o,u,c;for(o=1;o<=e;o+=1){for(c=0,i=1;i<o;i+=1)c+=r[i][o]*t[i];t[o]=(t[o]-c)/r[o][o]}for(u=1;u<=e;u+=1)for(t[o=e+1-u]=t[o]/r[o][o],c=-t[o],i=1;i<o;i+=1)t[i]=t[i]+c*r[i][o]}(r,0,t,n),function(r,n,e){var t,i,o,u,c;for(o=1;o<=e;o+=1){for(r[o][o]=1/r[o][o],c=-r[o][o],t=1;t<o;t+=1)r[t][o]=c*r[t][o];if(e<(u=o+1))break;for(i=u;i<=e;i+=1)for(c=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+c*r[t][o]}}(r,0,t)}else{for(y=1;y<=t;y+=1)for(i[y]=0,d=1;d<=y;d+=1)i[y]=i[y]+r[d][y]*n[d];for(y=1;y<=t;y+=1)for(n[y]=0,d=y;d<=t;d+=1)n[y]=n[y]+r[y][d]*i[d]}for(o[1]=0,y=1;y<=t;y+=1)for(i[y]=n[y],o[1]=o[1]+p[y]*i[y],p[y]=0,d=y+1;d<=t;d+=1)r[d][y]=0;for(o[1]=-o[1]/2,v[1]=0,O=(A=(M=(k=(j=(w=t)+t)+S)+S+1)+S*(S+1)/2)+f,d=1;d<=f;d+=1){for(V=0,y=1;y<=t;y+=1)V+=u[y][d]*u[y][d];p[O+d]=Math.sqrt(V)}function X(){for(h[1]=h[1]+1,g=A,d=1;d<=f;d+=1){for(g+=1,V=-c[d],y=1;y<=t;y+=1)V+=u[y][d]*i[y];if(Math.abs(V)<B&&(V=0),d>s)p[g]=V;else if(p[g]=-Math.abs(V),V>0){for(y=1;y<=t;y+=1)u[y][d]=-u[y][d];c[d]=-c[d]}}for(d=1;d<=l;d+=1)p[A+m[d]]=0;for(T=0,P=0,d=1;d<=f;d+=1)p[A+d]<P*p[O+d]&&(T=d,P=p[A+d]/p[O+d]);return 0===T?999:0}function Y(){for(d=1;d<=t;d+=1){for(V=0,y=1;y<=t;y+=1)V+=r[y][d]*u[y][T];p[d]=V}for(b=w,d=1;d<=t;d+=1)p[b+d]=0;for(y=l+1;y<=t;y+=1)for(d=1;d<=t;d+=1)p[b+d]=p[b+d]+r[d][y]*p[y];for(D=!0,d=l;d>=1;d-=1){for(V=p[d],b=(g=M+d*(d+3)/2)-d,y=d+1;y<=l;y+=1)V-=p[g]*p[j+y],g+=y;if(V/=p[b],p[j+d]=V,m[d]<s)break;if(V<0)break;D=!1,_=d}if(!D)for(q=p[k+_]/p[j+_],d=1;d<=l&&!(m[d]<s)&&!(p[j+d]<0);d+=1)(P=p[k+d]/p[j+d])<q&&(q=P,_=d);for(V=0,d=w+1;d<=w+t;d+=1)V+=p[d]*p[d];if(Math.abs(V)<=B){if(D)return v[1]=1,999;for(d=1;d<=l;d+=1)p[k+d]=p[k+d]-q*p[j+d];return p[k+l+1]=p[k+l+1]+q,700}for(V=0,d=1;d<=t;d+=1)V+=p[w+d]*u[d][T];for(F=-p[A+T]/V,U=!0,D||q<F&&(F=q,U=!1),d=1;d<=t;d+=1)i[d]=i[d]+F*p[w+d],Math.abs(i[d])<B&&(i[d]=0);for(o[1]=o[1]+F*V*(F/2+p[k+l+1]),d=1;d<=l;d+=1)p[k+d]=p[k+d]-F*p[j+d];if(p[k+l+1]=p[k+l+1]+F,!U){for(V=-c[T],y=1;y<=t;y+=1)V+=i[y]*u[y][T];if(T>s)p[A+T]=V;else if(p[A+T]=-Math.abs(V),V>0){for(y=1;y<=t;y+=1)u[y][T]=-u[y][T];c[T]=-c[T]}return 700}for(m[l+=1]=T,g=M+(l-1)*l/2+1,d=1;d<=l-1;d+=1)p[g]=p[d],g+=1;if(l===t)p[g]=p[t];else{for(d=t;d>=l+1&&0!==p[d]&&(E=Math.max(Math.abs(p[d-1]),Math.abs(p[d])),L=Math.min(Math.abs(p[d-1]),Math.abs(p[d])),P=p[d-1]>=0?Math.abs(E*Math.sqrt(1+L*L/(E*E))):-Math.abs(E*Math.sqrt(1+L*L/(E*E))),E=p[d-1]/P,L=p[d]/P,1!==E);d-=1)if(0===E)for(p[d-1]=L*P,y=1;y<=t;y+=1)P=r[y][d-1],r[y][d-1]=r[y][d],r[y][d]=P;else for(p[d-1]=P,N=L/(1+E),y=1;y<=t;y+=1)P=E*r[y][d-1]+L*r[y][d],r[y][d]=N*(r[y][d-1]+P)-r[y][d],r[y][d-1]=P;p[g]=p[l]}return 0}function $(){if(0===p[b=(g=M+_*(_+1)/2+1)+_])return 798;if(E=Math.max(Math.abs(p[b-1]),Math.abs(p[b])),L=Math.min(Math.abs(p[b-1]),Math.abs(p[b])),P=p[b-1]>=0?Math.abs(E*Math.sqrt(1+L*L/(E*E))):-Math.abs(E*Math.sqrt(1+L*L/(E*E))),E=p[b-1]/P,L=p[b]/P,1===E)return 798;if(0===E){for(d=_+1;d<=l;d+=1)P=p[b-1],p[b-1]=p[b],p[b]=P,b+=d;for(d=1;d<=t;d+=1)P=r[d][_],r[d][_]=r[d][_+1],r[d][_+1]=P}else{for(N=L/(1+E),d=_+1;d<=l;d+=1)P=E*p[b-1]+L*p[b],p[b]=N*(p[b-1]+P)-p[b],p[b-1]=P,b+=d;for(d=1;d<=t;d+=1)P=E*r[d][_]+L*r[d][_+1],r[d][_+1]=N*(r[d][_]+P)-r[d][_+1],r[d][_]=P}return 0}function Q(){for(b=g-_,d=1;d<=_;d+=1)p[b]=p[g],g+=1,b+=1;return p[k+_]=p[k+_+1],m[_]=m[_+1],(_+=1)<l?797:0}function z(){return p[k+l]=p[k+l+1],p[k+l+1]=0,m[l]=0,l-=1,h[2]=h[2]+1,0}for(l=0,h[1]=0,h[2]=0,I=0;;){if(999===(I=X()))return;for(;0!==(I=Y());){if(999===I)return;if(700===I)if(_===l)z();else{for(;$(),797===(I=Q()););z()}}}}numeric.solveQP=function(r,i,o,u,c,a){r=n(r),i=n(i),o=n(o);var f,s,m,l,h,p=[],v=[],d=[],y=[],g=[];if(c=c||0,a=a?n(a):[void 0,0],u=u?n(u):[],s=r.length-1,m=o[1].length-1,!u)for(f=1;f<=m;f+=1)u[f]=0;for(f=1;f<=m;f+=1)v[f]=0;for(0,l=Math.min(s,m),f=1;f<=s;f+=1)d[f]=0;for(p[1]=0,f=1;f<=2*s+l*(l+5)/2+2*m+1;f+=1)y[f]=0;for(f=1;f<=2;f+=1)g[f]=0;return t(r,i,0,s,d,p,o,u,0,m,c,v,0,g,y,a),h="",1===a[1]&&(h="constraints are inconsistent, no solution!"),2===a[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:e(d),value:e(p),unconstrained_solution:e(i),iterations:e(g),iact:e(v),message:h}}}(),numeric.svd=function(r){var n,e=numeric.epsilon,t=1e-64/e,i=0,o=0,u=0,c=0,a=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var l=new Array(m),h=new Array(m);for(o=0;o<m;o++)l[o]=h[o]=0;var p=numeric.rep([m,m],0);function v(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var d=0,y=0,g=0,b=0,x=0,_=0,w=0;for(o=0;o<m;o++){for(l[o]=y,w=0,a=o+1,u=o;u<s;u++)w+=f[u][o]*f[u][o];if(w<=t)y=0;else for(d=f[o][o],y=Math.sqrt(w),d>=0&&(y=-y),g=d*y-w,f[o][o]=d-y,u=a;u<m;u++){for(w=0,c=o;c<s;c++)w+=f[c][o]*f[c][u];for(d=w/g,c=o;c<s;c++)f[c][u]+=d*f[c][o]}for(h[o]=y,w=0,u=a;u<m;u++)w+=f[o][u]*f[o][u];if(w<=t)y=0;else{for(d=f[o][o+1],y=Math.sqrt(w),d>=0&&(y=-y),g=d*y-w,f[o][o+1]=d-y,u=a;u<m;u++)l[u]=f[o][u]/g;for(u=a;u<s;u++){for(w=0,c=a;c<m;c++)w+=f[u][c]*f[o][c];for(c=a;c<m;c++)f[u][c]+=w*l[c]}}(x=Math.abs(h[o])+Math.abs(l[o]))>b&&(b=x)}for(o=m-1;-1!=o;o+=-1){if(0!=y){for(g=y*f[o][o+1],u=a;u<m;u++)p[u][o]=f[o][u]/g;for(u=a;u<m;u++){for(w=0,c=a;c<m;c++)w+=f[o][c]*p[c][u];for(c=a;c<m;c++)p[c][u]+=w*p[c][o]}}for(u=a;u<m;u++)p[o][u]=0,p[u][o]=0;p[o][o]=1,y=l[o],a=o}for(o=m-1;-1!=o;o+=-1){for(a=o+1,y=h[o],u=a;u<m;u++)f[o][u]=0;if(0!=y){for(g=f[o][o]*y,u=a;u<m;u++){for(w=0,c=a;c<s;c++)w+=f[c][o]*f[c][u];for(d=w/g,c=o;c<s;c++)f[c][u]+=d*f[c][o]}for(u=o;u<s;u++)f[u][o]=f[u][o]/y}else for(u=o;u<s;u++)f[u][o]=0;f[o][o]+=1}for(e*=b,c=m-1;-1!=c;c+=-1)for(var j=0;j<50;j++){var M=!1;for(a=c;-1!=a;a+=-1){if(Math.abs(l[a])<=e){M=!0;break}if(Math.abs(h[a-1])<=e)break}if(!M){i=0,w=1;var A=a-1;for(o=a;o<c+1&&(d=w*l[o],l[o]=i*l[o],!(Math.abs(d)<=e));o++)for(g=v(d,y=h[o]),h[o]=g,i=y/g,w=-d/g,u=0;u<s;u++)x=f[u][A],_=f[u][o],f[u][A]=x*i+_*w,f[u][o]=-x*w+_*i}if(_=h[c],a==c){if(_<0)for(h[c]=-_,u=0;u<m;u++)p[u][c]=-p[u][c];break}if(j>=49)throw"Error: no convergence.";for(b=h[a],y=v(d=(((x=h[c-1])-_)*(x+_)+((y=l[c-1])-(g=l[c]))*(y+g))/(2*g*x),1),d=d<0?((b-_)*(b+_)+g*(x/(d-y)-g))/b:((b-_)*(b+_)+g*(x/(d+y)-g))/b,i=1,w=1,o=a+1;o<c+1;o++){for(y=l[o],x=h[o],g=w*y,y*=i,_=v(d,g),l[o-1]=_,d=b*(i=d/_)+y*(w=g/_),y=-b*w+y*i,g=x*w,x*=i,u=0;u<m;u++)b=p[u][o-1],_=p[u][o],p[u][o-1]=b*i+_*w,p[u][o]=-b*w+_*i;for(_=v(d,g),h[o-1]=_,d=(i=d/_)*y+(w=g/_)*x,b=-w*y+i*x,u=0;u<s;u++)x=f[u][o-1],_=f[u][o],f[u][o-1]=x*i+_*w,f[u][o]=-x*w+_*i}l[a]=0,l[c]=d,h[c]=b}for(o=0;o<h.length;o++)h[o]<e&&(h[o]=0);for(o=0;o<m;o++)for(u=o-1;u>=0;u--)if(h[u]<h[o]){for(i=h[u],h[u]=h[o],h[o]=i,c=0;c<f.length;c++)n=f[c][o],f[c][o]=f[c][u],f[c][u]=n;for(c=0;c<p.length;c++)n=p[c][o],p[c][o]=p[c][u],p[c][u]=n;o=u}return{U:f,S:h,V:p}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2])(2)});
